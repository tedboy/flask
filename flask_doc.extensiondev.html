

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5. Flask Extension Development &mdash; Flask API</title>
  

  
  
    <link rel="shortcut icon" href="_static/flask-favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Flask API" href="index.html"/>
        <link rel="up" title="Flask doc â€” Additional Notes" href="flask_doc2.html"/>
        <link rel="next" title="6. Pocoo Styleguide" href="flask_doc.styleguide.html"/>
        <link rel="prev" title="4. Unicode in Flask" href="flask_doc.unicode.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Flask API
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html">Flask Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/introduction.html">Introducing Flaskr</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/folders.html">Step 0: Creating The Folders</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/schema.html">Step 1: Database Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/setup.html">Step 2: Application Setup Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/setuptools.html">Step 3: Installing flaskr with setuptools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/dbcon.html">Step 4: Database Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/dbinit.html">Step 5: Creating The Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/views.html">Step 7: The View Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/views.html#show-entries">Show Entries</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/views.html#add-new-entry">Add New Entry</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/views.html#login-and-logout">Login and Logout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/templates.html">Step 8: The Templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/templates.html#layout-html">layout.html</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/templates.html#show-entries-html">show_entries.html</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/templates.html#login-html">login.html</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/css.html">Step 9: Adding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/testing.html">Bonus: Testing the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/testing.html#adding-tests-to-flaskr">Adding Tests to flaskr</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/testing.html#testing-setuptools">Testing + Setuptools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart/flask_doc.quickstart.html">Flask &#8212; Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart1.html">1. A Minimal Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart2.html">2. What to do if the Server does not Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart2.html#old-version-of-flask">2.1. Old Version of Flask</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart2.html#invalid-import-name">2.2. Invalid Import Name</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart3.html">3. Debug Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart4.html">4. Routing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart4.html#variable-rules">4.1. Variable Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart4.html#url-building">4.2. URL Building</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart4.html#http-methods">4.3. HTTP Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart5.html">5. Static Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart6.html">6. Rendering Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart7.html">7. Accessing Request Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#context-locals">7.1. Context Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#the-request-object">7.2. The Request Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#file-uploads">7.3. File Uploads</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#cookies">7.4. Cookies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart8.html">8. Redirects and Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart9.html">9. About Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart10.html">10. Sessions</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart11.html">11. Message Flashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart12.html">12. Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart13.html">13. Hooking in WSGI Middlewares</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart13.html#using-flask-extensions">14. Using Flask Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart13.html#deploying-to-a-web-server">15. Deploying to a Web Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns/index1.html">Patterns for Flask (part1)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns/packages.html">1. Larger Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/packages.html#simple-packages">1.1. Simple Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/packages.html#working-with-blueprints">1.2. Working with Blueprints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/appfactories.html">2. Application Factories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#basic-factories">2.1. Basic Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#factories-extensions">2.2. Factories &amp; Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#using-applications">2.3. Using Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#factory-improvements">2.4. Factory Improvements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/appdispatch.html">3. Application Dispatching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#working-with-this-document">3.1. Working with this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#combining-applications">3.2. Combining Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#dispatch-by-subdomain">3.3. Dispatch by Subdomain</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#dispatch-by-path">3.4. Dispatch by Path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/apierrors.html">4. Implementing API Exceptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/apierrors.html#simple-exception-class">4.1. Simple Exception Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/apierrors.html#registering-an-error-handler">4.2. Registering an Error Handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/apierrors.html#usage-in-views">4.3. Usage in Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/urlprocessors.html">5. Using URL Processors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/urlprocessors.html#internationalized-application-urls">5.1. Internationalized Application URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/urlprocessors.html#internationalized-blueprint-urls">5.2. Internationalized Blueprint URLs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/distribute.html">6. Deploying with Setuptools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#basic-setup-script">6.1. Basic Setup Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#tagging-builds">6.2. Tagging Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#distributing-resources">6.3. Distributing Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#declaring-dependencies">6.4. Declaring Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#installing-developing">6.5. Installing / Developing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/fabric.html">7. Deploying with Fabric</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#creating-the-first-fabfile">7.1. Creating the first Fabfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#running-fabfiles">7.2. Running Fabfiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#the-wsgi-file">7.3. The WSGI File</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#the-configuration-file">7.4. The Configuration File</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#first-deployment">7.5. First Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#next-steps">7.6. Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/sqlite3.html">8. Using SQLite 3 with Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlite3.html#connect-on-demand">8.1. Connect on Demand</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlite3.html#easy-querying">8.2. Easy Querying</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlite3.html#initial-schemas">8.3. Initial Schemas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/sqlalchemy.html">9. SQLAlchemy in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#flask-sqlalchemy-extension">9.1. Flask-SQLAlchemy Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#declarative">9.2. Declarative</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#manual-object-relational-mapping">9.3. Manual Object Relational Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#sql-abstraction-layer">9.4. SQL Abstraction Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/fileuploads.html">10. Uploading Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#a-gentle-introduction">10.1. A Gentle Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#improving-uploads">10.2. Improving Uploads</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#upload-progress-bars">10.3. Upload Progress Bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#an-easier-solution">10.4. An Easier Solution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/caching.html">11. Caching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/caching.html#setting-up-a-cache">11.1. Setting up a Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/caching.html#using-a-cache">11.2. Using a Cache</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/viewdecorators.html">12. View Decorators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#login-required-decorator">12.1. Login Required Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#caching-decorator">12.2. Caching Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#templating-decorator">12.3. Templating Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#endpoint-decorator">12.4. Endpoint Decorator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/wtforms.html">13. Form Validation with WTForms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/wtforms.html#the-forms">13.1. The Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/wtforms.html#in-the-view">13.2. In the View</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/wtforms.html#forms-in-templates">13.3. Forms in Templates</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns/index2.html">Patterns for Flask (part2)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns/templateinheritance.html">1. Template Inheritance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/templateinheritance.html#base-template">1.1. Base Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/templateinheritance.html#child-template">1.2. Child Template</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/flashing.html">2. Message Flashing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/flashing.html#simple-flashing">2.1. Simple Flashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/flashing.html#flashing-with-categories">2.2. Flashing With Categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/flashing.html#filtering-flash-messages">2.3. Filtering Flash Messages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/jquery.html">3. AJAX with jQuery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#loading-jquery">3.1. Loading jQuery</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#where-is-my-site">3.2. Where is My Site?</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#json-view-functions">3.3. JSON View Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#the-html">3.4. The HTML</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/errorpages.html">4. Custom Error Pages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/errorpages.html#common-error-codes">4.1. Common Error Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/errorpages.html#error-handlers">4.2. Error Handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/lazyloading.html">5. Lazily Loading Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/lazyloading.html#converting-to-centralized-url-map">5.1. Converting to Centralized URL Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/lazyloading.html#loading-late">5.2. Loading Late</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/mongokit.html">6. MongoKit in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/mongokit.html#declarative">6.1. Declarative</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/mongokit.html#pymongo-compatibility-layer">6.2. PyMongo Compatibility Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/favicon.html">7. Adding a favicon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/favicon.html#see-also">7.1. See also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/streaming.html">8. Streaming Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/streaming.html#basic-usage">8.1. Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/streaming.html#streaming-from-templates">8.2. Streaming from Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/streaming.html#streaming-with-context">8.3. Streaming with Context</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/deferredcallbacks.html">9. Deferred Request Callbacks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/deferredcallbacks.html#the-decorator">9.1. The Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/deferredcallbacks.html#calling-the-deferred">9.2. Calling the Deferred</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/deferredcallbacks.html#a-practical-example">9.3. A Practical Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/methodoverrides.html">10. Adding HTTP Method Overrides</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns/requestchecksum.html">11. Request Content Checksums</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns/celery.html">12. Celery Based Background Tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#installing-celery">12.1. Installing Celery</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#configuring-celery">12.2. Configuring Celery</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#minimal-example">12.3. Minimal Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#running-the-celery-worker">12.4. Running the Celery Worker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/subclassing.html">13. Subclassing Flask</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploying/index.html">Deployment Options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="deploying/index.html#hosted-options">Hosted options</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploying/index.html#self-hosted-options">Self-hosted options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deploying/mod_wsgi.html">1. mod_wsgi (Apache)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#installing-mod-wsgi">1.1. Installing <cite>mod_wsgi</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#creating-a-wsgi-file">1.2. Creating a <cite>.wsgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#configuring-apache">1.3. Configuring Apache</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#troubleshooting">1.4. Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#support-for-automatic-reloading">1.5. Support for Automatic Reloading</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#working-with-virtual-environments">1.6. Working with Virtual Environments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/wsgi-standalone.html">2. Standalone WSGI Containers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#gunicorn">2.1. Gunicorn</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#gevent">2.2. Gevent</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#twisted-web">2.3. Twisted Web</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#proxy-setups">2.4. Proxy Setups</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/uwsgi.html">3. uWSGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/uwsgi.html#starting-your-app-with-uwsgi">3.1. Starting your app with uwsgi</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/uwsgi.html#configuring-nginx">3.2. Configuring nginx</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/fastcgi.html">4. FastCGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#creating-a-fcgi-file">4.1. Creating a <cite>.fcgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#configuring-apache">4.2. Configuring Apache</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#configuring-lighttpd">4.3. Configuring lighttpd</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#configuring-nginx">4.4. Configuring nginx</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#running-fastcgi-processes">4.5. Running FastCGI Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#debugging">4.6. Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/cgi.html">5. CGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/cgi.html#creating-a-cgi-file">5.1. Creating a <cite>.cgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/cgi.html#server-setup">5.2. Server Setup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc.templating.html">1&nbsp;&nbsp;&nbsp;Flask &#8212; Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#jinja-setup">1.1&nbsp;&nbsp;&nbsp;Jinja Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#standard-context">1.2&nbsp;&nbsp;&nbsp;Standard Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#standard-filters">1.3&nbsp;&nbsp;&nbsp;Standard Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#controlling-autoescaping">1.4&nbsp;&nbsp;&nbsp;Controlling Autoescaping</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#registering-filters">1.5&nbsp;&nbsp;&nbsp;Registering Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#context-processors">1.6&nbsp;&nbsp;&nbsp;Context Processors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc.config.html">1&nbsp;&nbsp;&nbsp;Configuration Handling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#configuration-basics">1.1&nbsp;&nbsp;&nbsp;Configuration Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#builtin-configuration-values">1.2&nbsp;&nbsp;&nbsp;Builtin Configuration Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#configuring-from-files">1.3&nbsp;&nbsp;&nbsp;Configuring from Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#configuration-best-practices">1.4&nbsp;&nbsp;&nbsp;Configuration Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#development-production">1.5&nbsp;&nbsp;&nbsp;Development / Production</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#instance-folders">1.6&nbsp;&nbsp;&nbsp;Instance Folders</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc.testing.html">1&nbsp;&nbsp;&nbsp;Testing Flask Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#the-application">1.1&nbsp;&nbsp;&nbsp;The Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#the-testing-skeleton">1.2&nbsp;&nbsp;&nbsp;The Testing Skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#the-first-test">1.3&nbsp;&nbsp;&nbsp;The First Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#logging-in-and-out">1.4&nbsp;&nbsp;&nbsp;Logging In and Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#test-adding-messages">1.5&nbsp;&nbsp;&nbsp;Test Adding Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#other-testing-tricks">1.6&nbsp;&nbsp;&nbsp;Other Testing Tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#faking-resources-and-context">1.7&nbsp;&nbsp;&nbsp;Faking Resources and Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#keeping-the-context-around">1.8&nbsp;&nbsp;&nbsp;Keeping the Context Around</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#accessing-and-modifying-sessions">1.9&nbsp;&nbsp;&nbsp;Accessing and Modifying Sessions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc.html">Other Flask doc materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.foreword.html">1. Foreword</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#what-does-micro-mean">1.1. What does &#8220;micro&#8221; mean?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#configuration-and-conventions">1.2. Configuration and Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#growing-with-flask">1.3. Growing with Flask</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.advanced_foreword.html">2. Foreword for Experienced Programmers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#thread-locals-in-flask">2.1. Thread-Locals in Flask</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#develop-for-the-web-with-caution">2.2. Develop for the Web with Caution</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#python-3-support-in-flask">2.3. Python 3 Support in Flask</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.installation.html">3. Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#virtualenv">3.1. virtualenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#system-wide-installation">3.2. System-Wide Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#living-on-the-edge">3.3. Living on the Edge</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#pip-and-setuptools-on-windows">3.4. <cite>pip</cite> and <cite>setuptools</cite> on Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.errorhandling.html">4. Application Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-logging-tools">4.1. Error Logging Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-handlers">4.2. Error handlers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#registering">4.2.1. Registering</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#handling">4.2.2. Handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-mails">4.3. Error Mails</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#logging-to-a-file">4.4. Logging to a File</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#controlling-the-log-format">4.5. Controlling the Log Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#email">4.5.1. Email</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#file-logging">4.5.2. File logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#complex-log-formatting">4.5.3. Complex Log Formatting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#other-libraries">4.6. Other Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.errorhandling.html#debugging-application-errors">5. Debugging Application Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#when-in-doubt-run-manually">5.1. When in Doubt, Run Manually</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#working-with-debuggers">5.2. Working with Debuggers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.signals.html">6. Signals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#subscribing-to-signals">6.1. Subscribing to Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#creating-signals">6.2. Creating Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#sending-signals">6.3. Sending Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#signals-and-flask-s-request-context">6.4. Signals and Flask&#8217;s Request Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#decorator-based-signal-subscriptions">6.5. Decorator Based Signal Subscriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#core-signals">6.6. Core Signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.views.html">7. Pluggable Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#basic-principle">7.1. Basic Principle</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-hints">7.2. Method Hints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-based-dispatching">7.3. Method Based Dispatching</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#decorating-views">7.4. Decorating Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-views-for-apis">7.5. Method Views for APIs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.appcontext.html">8. The Application Context</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#purpose-of-the-application-context">8.1. Purpose of the Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#creating-an-application-context">8.2. Creating an Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#locality-of-the-context">8.3. Locality of the Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#context-usage">8.4. Context Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.reqcontext.html">9. The Request Context</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#diving-into-context-locals">9.1. Diving into Context Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#how-the-context-works">9.2. How the Context Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#callbacks-and-errors">9.3. Callbacks and Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#teardown-callbacks">9.4. Teardown Callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#notes-on-proxies">9.5. Notes On Proxies</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#context-preservation-on-error">9.6. Context Preservation on Error</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.blueprints.html">10. Modular Applications with Blueprints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#why-blueprints">10.1. Why Blueprints?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#the-concept-of-blueprints">10.2. The Concept of Blueprints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#my-first-blueprint">10.3. My First Blueprint</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#registering-blueprints">10.4. Registering Blueprints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#blueprint-resources">10.5. Blueprint Resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#blueprint-resource-folder">10.5.1. Blueprint Resource Folder</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#static-files">10.5.2. Static Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#templates">10.5.3. Templates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#building-urls">10.6. Building URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#error-handlers">10.7. Error Handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.extensions.html">11. Flask Extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#finding-extensions">11.1. Finding Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#using-extensions">11.2. Using Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#building-extensions">11.3. Building Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#flask-before-0-8">11.4. Flask Before 0.8</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.cli.html">12. Command Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#basic-usage">12.1. Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#virtualenv-integration">12.2. Virtualenv Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#debug-flag">12.3. Debug Flag</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#running-a-shell">12.4. Running a Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#custom-commands">12.5. Custom Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#application-context">12.6. Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#factory-functions">12.7. Factory Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#custom-scripts">12.8. Custom Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#cli-plugins">12.9. CLI Plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.server.html">13. Development Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.server.html#command-line">13.1. Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.server.html#in-code">13.2. In Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.shell.html">14. Working with the Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#command-line-interface">14.1. Command Line Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#creating-a-request-context">14.2. Creating a Request Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#firing-before-after-request">14.3. Firing Before/After Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#further-improving-the-shell-experience">14.4. Further Improving the Shell Experience</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.becomingbig.html">15. Becoming Big</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#read-the-source">15.1. Read the Source.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#hook-extend">15.2. Hook. Extend.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#subclass">15.3. Subclass.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#wrap-with-middleware">15.4. Wrap with middleware.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#fork">15.5. Fork.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#scale-like-a-pro">15.6. Scale like a pro.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#discuss-with-the-community">15.7. Discuss with the community.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="flask_doc2.html">Flask doc &#8212; Additional Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="flask_doc.design.html">1. Design Decisions in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#the-explicit-application-object">1.1. The Explicit Application Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#the-routing-system">1.2. The Routing System</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#one-template-engine">1.3. One Template Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#micro-with-dependencies">1.4. Micro with Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#thread-locals">1.5. Thread Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#what-flask-is-what-flask-is-not">1.6. What Flask is, What Flask is Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.htmlfaq.html">2. HTML/XHTML FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#history-of-xhtml">2.1. History of XHTML</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#history-of-html5">2.2. History of HTML5</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#html-versus-xhtml">2.3. HTML versus XHTML</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#what-does-strict-mean">2.4. What does &#8220;strict&#8221; mean?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#new-technologies-in-html5">2.5. New technologies in HTML5</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#what-should-be-used">2.6. What should be used?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.security.html">3. Security Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#cross-site-scripting-xss">3.1. Cross-Site Scripting (XSS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#cross-site-request-forgery-csrf">3.2. Cross-Site Request Forgery (CSRF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#json-security">3.3. JSON Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.unicode.html">4. Unicode in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#automatic-conversion">4.1. Automatic Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#the-golden-rule">4.2. The Golden Rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#encoding-and-decoding-yourself">4.3. Encoding and Decoding Yourself</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#configuring-editors">4.4. Configuring Editors</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">5. Flask Extension Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#anatomy-of-an-extension">5.1. Anatomy of an Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hello-flaskext">5.2. &#8220;Hello Flaskext!&#8221;</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#setup-py">5.2.1. setup.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="#flask-sqlite3-py">5.2.2. flask_sqlite3.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#initializing-extensions">5.3. Initializing Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-extension-code">5.4. The Extension Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-app-ctx-stack">5.5. Using _app_ctx_stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="#teardown-behavior">5.6. Teardown Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="#learn-from-others">5.7. Learn from Others</a></li>
<li class="toctree-l3"><a class="reference internal" href="#approved-extensions">5.8. Approved Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extension-import-transition">5.9. Extension Import Transition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.styleguide.html">6. Pocoo Styleguide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#general-layout">6.1. General Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#expressions-and-statements">6.2. Expressions and Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#naming-conventions">6.3. Naming Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#docstrings">6.4. Docstrings</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#comments">6.5. Comments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="werk_doc.html">Werkzeug doc materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.tutorial.html">1. Werkzeug Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#introducing-shortly">1.1. Introducing Shortly</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-0-a-basic-wsgi-introduction">1.2. Step 0: A Basic WSGI Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-1-creating-the-folders">1.3. Step 1: Creating the Folders</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-2-the-base-structure">1.4. Step 2: The Base Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#intermezzo-running-the-application">1.5. Intermezzo: Running the Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-3-the-environment">1.6. Step 3: The Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-4-the-routing">1.7. Step 4: The Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-5-the-first-view">1.8. Step 5: The First View</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-6-redirect-view">1.9. Step 6: Redirect View</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-7-detail-view">1.10. Step 7: Detail View</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-8-templates">1.11. Step 8: Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-9-the-style">1.12. Step 9: The Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#bonus-refinements">1.13. Bonus: Refinements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.quickstart.html">2. Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#wsgi-environment">2.1. WSGI Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#enter-request">2.2. Enter Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#header-parsing">2.3. Header Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#responses">2.4. Responses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.deployment.html">3. Application Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.cgi.html">3.1. CGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.cgi.html#creating-a-cgi-file">3.1.1. Creating a <cite>.cgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.cgi.html#server-setup">3.1.2. Server Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html">3.2. <cite>mod_wsgi</cite> (Apache)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#installing-mod-wsgi">3.2.1. Installing <cite>mod_wsgi</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#creating-a-wsgi-file">3.2.2. Creating a <cite>.wsgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#configuring-apache">3.2.3. Configuring Apache</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.fastcgi.html">3.3. FastCGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#creating-a-fcgi-file">3.3.1. Creating a <cite>.fcgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#configuring-lighttpd">3.3.2. Configuring lighttpd</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#configuring-nginx">3.3.3. Configuring nginx</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#debugging">3.3.4. Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.proxying.html">3.4. HTTP Proxying</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.proxying.html#creating-a-py-server">3.4.1. Creating a <cite>.py</cite> server</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.proxying.html#configuring-nginx">3.4.2. Configuring nginx</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flask API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="flask_doc2.html">Flask doc &#8212; Additional Notes</a> &raquo;</li>
        
      <li>5. Flask Extension Development</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/flask_doc.extensiondev.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="flask-extension-development">
<span id="extension-dev"></span><h1>5. Flask Extension Development<a class="headerlink" href="#flask-extension-development" title="Permalink to this headline">Â¶</a></h1>
<p>Flask, being a microframework, often requires some repetitive steps to get
a third party library working.  Because very often these steps could be
abstracted to support multiple projects the <a class="reference external" href="http://flask.pocoo.org/extensions/">Flask Extension Registry</a>
was created.</p>
<p>If you want to create your own Flask extension for something that does not
exist yet, this guide to extension development will help you get your
extension running in no time and to feel like users would expect your
extension to behave.</p>
<div class="section" id="anatomy-of-an-extension">
<h2>5.1. Anatomy of an Extension<a class="headerlink" href="#anatomy-of-an-extension" title="Permalink to this headline">Â¶</a></h2>
<p>Extensions are all located in a package called <code class="docutils literal"><span class="pre">flask_something</span></code>
where &#8220;something&#8221; is the name of the library you want to bridge.  So for
example if you plan to add support for a library named <cite>simplexml</cite> to
Flask, you would name your extension&#8217;s package <code class="docutils literal"><span class="pre">flask_simplexml</span></code>.</p>
<p>The name of the actual extension (the human readable name) however would
be something like &#8220;Flask-SimpleXML&#8221;.  Make sure to include the name
&#8220;Flask&#8221; somewhere in that name and that you check the capitalization.
This is how users can then register dependencies to your extension in
their <code class="file docutils literal"><span class="pre">setup.py</span></code> files.</p>
<p>Flask sets up a redirect package called <code class="xref py py-data docutils literal"><span class="pre">flask.ext</span></code> where users
should import the extensions from.  If you for instance have a package
called <code class="docutils literal"><span class="pre">flask_something</span></code> users would import it as
<code class="docutils literal"><span class="pre">flask.ext.something</span></code>.  This is done to transition from the old
namespace packages.  See <a class="reference internal" href="#ext-import-transition"><span>Extension Import Transition</span></a> for more details.</p>
<p>But what do extensions look like themselves?  An extension has to ensure
that it works with multiple Flask application instances at once.  This is
a requirement because many people will use patterns like the
<a class="reference internal" href="patterns/appfactories.html#app-factories"><span>Application Factories</span></a> pattern to create their application as needed to aid
unittests and to support multiple configurations.  Because of that it is
crucial that your application supports that kind of behavior.</p>
<p>Most importantly the extension must be shipped with a <code class="file docutils literal"><span class="pre">setup.py</span></code> file and
registered on PyPI.  Also the development checkout link should work so
that people can easily install the development version into their
virtualenv without having to download the library by hand.</p>
<p>Flask extensions must be licensed under a BSD, MIT or more liberal license
to be able to be enlisted in the Flask Extension Registry.  Keep in mind
that the Flask Extension Registry is a moderated place and libraries will
be reviewed upfront if they behave as required.</p>
</div>
<div class="section" id="hello-flaskext">
<h2>5.2. &#8220;Hello Flaskext!&#8221;<a class="headerlink" href="#hello-flaskext" title="Permalink to this headline">Â¶</a></h2>
<p>So let&#8217;s get started with creating such a Flask extension.  The extension
we want to create here will provide very basic support for SQLite3.</p>
<p>First we create the following folder structure:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>flask-sqlite3/
    flask_sqlite3.py
    LICENSE
    README
</pre></div>
</div>
<p>Here&#8217;s the contents of the most important files:</p>
<div class="section" id="setup-py">
<h3>5.2.1. setup.py<a class="headerlink" href="#setup-py" title="Permalink to this headline">Â¶</a></h3>
<p>The next file that is absolutely required is the <code class="file docutils literal"><span class="pre">setup.py</span></code> file which is
used to install your Flask extension.  The following contents are
something you can work with:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Flask-SQLite3</span>
<span class="sd">-------------</span>

<span class="sd">This is the description for that library</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">setuptools</span> <span class="kn">import</span> <span class="n">setup</span>


<span class="n">setup</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Flask-SQLite3&#39;</span><span class="p">,</span>
    <span class="n">version</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span>
    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://example.com/flask-sqlite3/&#39;</span><span class="p">,</span>
    <span class="n">license</span><span class="o">=</span><span class="s1">&#39;BSD&#39;</span><span class="p">,</span>
    <span class="n">author</span><span class="o">=</span><span class="s1">&#39;Your Name&#39;</span><span class="p">,</span>
    <span class="n">author_email</span><span class="o">=</span><span class="s1">&#39;your-email@example.com&#39;</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="s1">&#39;Very short description&#39;</span><span class="p">,</span>
    <span class="n">long_description</span><span class="o">=</span><span class="n">__doc__</span><span class="p">,</span>
    <span class="n">py_modules</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;flask_sqlite3&#39;</span><span class="p">],</span>
    <span class="c1"># if you would be using a package instead use packages instead</span>
    <span class="c1"># of py_modules:</span>
    <span class="c1"># packages=[&#39;flask_sqlite3&#39;],</span>
    <span class="n">zip_safe</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
    <span class="n">include_package_data</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
    <span class="n">platforms</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">,</span>
    <span class="n">install_requires</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;Flask&#39;</span>
    <span class="p">],</span>
    <span class="n">classifiers</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;Environment :: Web Environment&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Intended Audience :: Developers&#39;</span><span class="p">,</span>
        <span class="s1">&#39;License :: OSI Approved :: BSD License&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Operating System :: OS Independent&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Programming Language :: Python&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Topic :: Internet :: WWW/HTTP :: Dynamic Content&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Topic :: Software Development :: Libraries :: Python Modules&#39;</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<p>That&#8217;s a lot of code but you can really just copy/paste that from existing
extensions and adapt.</p>
</div>
<div class="section" id="flask-sqlite3-py">
<h3>5.2.2. flask_sqlite3.py<a class="headerlink" href="#flask-sqlite3-py" title="Permalink to this headline">Â¶</a></h3>
<p>Now this is where your extension code goes.  But how exactly should such
an extension look like?  What are the best practices?  Continue reading
for some insight.</p>
</div>
</div>
<div class="section" id="initializing-extensions">
<h2>5.3. Initializing Extensions<a class="headerlink" href="#initializing-extensions" title="Permalink to this headline">Â¶</a></h2>
<p>Many extensions will need some kind of initialization step.  For example,
consider an application that&#8217;s currently connecting to SQLite like the
documentation suggests (<a class="reference internal" href="patterns/sqlite3.html#sqlite3"><span>Using SQLite 3 with Flask</span></a>).  So how does the extension
know the name of the application object?</p>
<p>Quite simple: you pass it to it.</p>
<p>There are two recommended ways for an extension to initialize:</p>
<p>initialization functions:</p>
<blockquote>
<div>If your extension is called <cite>helloworld</cite> you might have a function
called <code class="docutils literal"><span class="pre">init_helloworld(app[,</span> <span class="pre">extra_args])</span></code> that initializes the
extension for that application.  It could attach before / after
handlers etc.</div></blockquote>
<p>classes:</p>
<blockquote>
<div>Classes work mostly like initialization functions but can later be
used to further change the behavior.  For an example look at how the
<a class="reference external" href="http://pythonhosted.org/Flask-OAuth/">OAuth extension</a> works: there is an <cite>OAuth</cite> object that provides
some helper functions like <cite>OAuth.remote_app</cite> to create a reference to
a remote application that uses OAuth.</div></blockquote>
<p>What to use depends on what you have in mind.  For the SQLite 3 extension
we will use the class-based approach because it will provide users with an
object that handles opening and closing database connections.</p>
<p>What&#8217;s important about classes is that they encourage to be shared around
on module level.  In that case, the object itself must not under any
circumstances store any application specific state and must be shareable
between different application.</p>
</div>
<div class="section" id="the-extension-code">
<h2>5.4. The Extension Code<a class="headerlink" href="#the-extension-code" title="Permalink to this headline">Â¶</a></h2>
<p>Here&#8217;s the contents of the <cite>flask_sqlite3.py</cite> for copy/paste:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">current_app</span>

<span class="c1"># Find the stack on which we want to store the database connection.</span>
<span class="c1"># Starting with Flask 0.9, the _app_ctx_stack is the correct one,</span>
<span class="c1"># before that we need to use the _request_ctx_stack.</span>
<span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">_app_ctx_stack</span> <span class="k">as</span> <span class="n">stack</span>
<span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">_request_ctx_stack</span> <span class="k">as</span> <span class="n">stack</span>


<span class="k">class</span> <span class="nc">SQLite3</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">app</span> <span class="o">=</span> <span class="n">app</span>
        <span class="k">if</span> <span class="n">app</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">init_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">app</span><span class="p">):</span>
        <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;SQLITE3_DATABASE&#39;</span><span class="p">,</span> <span class="s1">&#39;:memory:&#39;</span><span class="p">)</span>
        <span class="c1"># Use the newstyle teardown_appcontext if it&#39;s available,</span>
        <span class="c1"># otherwise fall back to the request context</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="s1">&#39;teardown_appcontext&#39;</span><span class="p">):</span>
            <span class="n">app</span><span class="o">.</span><span class="n">teardown_appcontext</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">teardown</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">app</span><span class="o">.</span><span class="n">teardown_request</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">teardown</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">connect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">current_app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;SQLITE3_DATABASE&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">teardown</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exception</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">top</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="s1">&#39;sqlite3_db&#39;</span><span class="p">):</span>
            <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">connection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">ctx</span> <span class="o">=</span> <span class="n">stack</span><span class="o">.</span><span class="n">top</span>
        <span class="k">if</span> <span class="n">ctx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span> <span class="s1">&#39;sqlite3_db&#39;</span><span class="p">):</span>
                <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span>
</pre></div>
</div>
<p>So here&#8217;s what these lines of code do:</p>
<ol class="arabic">
<li><p class="first">The <code class="docutils literal"><span class="pre">__init__</span></code> method takes an optional app object and, if supplied, will
call <code class="docutils literal"><span class="pre">init_app</span></code>.</p>
</li>
<li><p class="first">The <code class="docutils literal"><span class="pre">init_app</span></code> method exists so that the <code class="docutils literal"><span class="pre">SQLite3</span></code> object can be
instantiated without requiring an app object.  This method supports the
factory pattern for creating applications.  The <code class="docutils literal"><span class="pre">init_app</span></code> will set the
configuration for the database, defaulting to an in memory database if
no configuration is supplied.  In addition, the <code class="docutils literal"><span class="pre">init_app</span></code> method attaches
the <code class="docutils literal"><span class="pre">teardown</span></code> handler.  It will try to use the newstyle app context
handler and if it does not exist, falls back to the request context
one.</p>
</li>
<li><p class="first">Next, we define a <code class="docutils literal"><span class="pre">connect</span></code> method that opens a database connection.</p>
</li>
<li><p class="first">Finally, we add a <code class="docutils literal"><span class="pre">connection</span></code> property that on first access opens
the database connection and stores it on the context.  This is also
the recommended way to handling resources: fetch resources lazily the
first time they are used.</p>
<p>Note here that we&#8217;re attaching our database connection to the top
application context via <code class="docutils literal"><span class="pre">_app_ctx_stack.top</span></code>. Extensions should use
the top context for storing their own information with a sufficiently
complex name.  Note that we&#8217;re falling back to the
<code class="docutils literal"><span class="pre">_request_ctx_stack.top</span></code> if the application is using an older
version of Flask that does not support it.</p>
</li>
</ol>
<p>So why did we decide on a class-based approach here?  Because using our
extension looks something like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_sqlite3</span> <span class="kn">import</span> <span class="n">SQLite3</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">from_pyfile</span><span class="p">(</span><span class="s1">&#39;the-config.cfg&#39;</span><span class="p">)</span>
<span class="n">db</span> <span class="o">=</span> <span class="n">SQLite3</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>You can then use the database from views like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@app.route</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">show_all</span><span class="p">():</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>Likewise if you are outside of a request but you are using Flask 0.9 or
later with the app context support, you can use the database in the same
way:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">app_context</span><span class="p">():</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
    <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
</pre></div>
</div>
<p>At the end of the <code class="docutils literal"><span class="pre">with</span></code> block the teardown handles will be executed
automatically.</p>
<p>Additionally, the <code class="docutils literal"><span class="pre">init_app</span></code> method is used to support the factory pattern
for creating apps:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">db</span> <span class="o">=</span> <span class="n">Sqlite3</span><span class="p">()</span>
<span class="c1"># Then later on.</span>
<span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">(</span><span class="s1">&#39;the-config.cfg&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">init_app</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
<p>Keep in mind that supporting this factory pattern for creating apps is required
for approved flask extensions (described below).</p>
<div class="admonition-note-on-init-app admonition">
<p class="first admonition-title">Note on <code class="docutils literal"><span class="pre">init_app</span></code></p>
<p>As you noticed, <code class="docutils literal"><span class="pre">init_app</span></code> does not assign <code class="docutils literal"><span class="pre">app</span></code> to <code class="docutils literal"><span class="pre">self</span></code>.  This
is intentional!  Class based Flask extensions must only store the
application on the object when the application was passed to the
constructor.  This tells the extension: I am not interested in using
multiple applications.</p>
<p class="last">When the extension needs to find the current application and it does
not have a reference to it, it must either use the
<code class="xref py py-data docutils literal"><span class="pre">current_app</span></code> context local or change the API in a way
that you can pass the application explicitly.</p>
</div>
</div>
<div class="section" id="using-app-ctx-stack">
<h2>5.5. Using _app_ctx_stack<a class="headerlink" href="#using-app-ctx-stack" title="Permalink to this headline">Â¶</a></h2>
<p>In the example above, before every request, a <code class="docutils literal"><span class="pre">sqlite3_db</span></code> variable is
assigned to <code class="docutils literal"><span class="pre">_app_ctx_stack.top</span></code>.  In a view function, this variable is
accessible using the <code class="docutils literal"><span class="pre">connection</span></code> property of <code class="docutils literal"><span class="pre">SQLite3</span></code>.  During the
teardown of a request, the <code class="docutils literal"><span class="pre">sqlite3_db</span></code> connection is closed.  By using
this pattern, the <em>same</em> connection to the sqlite3 database is accessible
to anything that needs it for the duration of the request.</p>
<p>If the <code class="xref py py-data docutils literal"><span class="pre">_app_ctx_stack</span></code> does not exist because the user uses
an old version of Flask, it is recommended to fall back to
<code class="xref py py-data docutils literal"><span class="pre">_request_ctx_stack</span></code> which is bound to a request.</p>
</div>
<div class="section" id="teardown-behavior">
<h2>5.6. Teardown Behavior<a class="headerlink" href="#teardown-behavior" title="Permalink to this headline">Â¶</a></h2>
<p><em>This is only relevant if you want to support Flask 0.6 and older</em></p>
<p>Due to the change in Flask 0.7 regarding functions that are run at the end
of the request your extension will have to be extra careful there if it
wants to continue to support older versions of Flask.  The following
pattern is a good way to support both:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">close_connection</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="n">ctx</span> <span class="o">=</span> <span class="n">_request_ctx_stack</span><span class="o">.</span><span class="n">top</span>
    <span class="n">ctx</span><span class="o">.</span><span class="n">sqlite3_db</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="s1">&#39;teardown_request&#39;</span><span class="p">):</span>
    <span class="n">app</span><span class="o">.</span><span class="n">teardown_request</span><span class="p">(</span><span class="n">close_connection</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">after_request</span><span class="p">(</span><span class="n">close_connection</span><span class="p">)</span>
</pre></div>
</div>
<p>Strictly speaking the above code is wrong, because teardown functions are
passed the exception and typically don&#8217;t return anything.  However because
the return value is discarded this will just work assuming that the code
in between does not touch the passed parameter.</p>
</div>
<div class="section" id="learn-from-others">
<h2>5.7. Learn from Others<a class="headerlink" href="#learn-from-others" title="Permalink to this headline">Â¶</a></h2>
<p>This documentation only touches the bare minimum for extension
development.  If you want to learn more, it&#8217;s a very good idea to check
out existing extensions on the <a class="reference external" href="http://flask.pocoo.org/extensions/">Flask Extension Registry</a>.  If you feel
lost there is still the <a class="reference external" href="http://flask.pocoo.org/mailinglist/">mailinglist</a> and the <a class="reference external" href="http://flask.pocoo.org/community/irc/">IRC channel</a> to get some
ideas for nice looking APIs.  Especially if you do something nobody before
you did, it might be a very good idea to get some more input.  This not
only to get an idea about what people might want to have from an
extension, but also to avoid having multiple developers working on pretty
much the same side by side.</p>
<p>Remember: good API design is hard, so introduce your project on the
mailinglist, and let other developers give you a helping hand with
designing the API.</p>
<p>The best Flask extensions are extensions that share common idioms for the
API.  And this can only work if collaboration happens early.</p>
</div>
<div class="section" id="approved-extensions">
<h2>5.8. Approved Extensions<a class="headerlink" href="#approved-extensions" title="Permalink to this headline">Â¶</a></h2>
<p>Flask also has the concept of approved extensions.  Approved extensions
are tested as part of Flask itself to ensure extensions do not break on
new releases.  These approved extensions are listed on the <a class="reference external" href="http://flask.pocoo.org/extensions/">Flask
Extension Registry</a> and marked appropriately.  If you want your own
extension to be approved you have to follow these guidelines:</p>
<ol class="arabic simple" start="0">
<li>An approved Flask extension requires a maintainer. In the event an
extension author would like to move beyond the project, the project should
find a new maintainer including full source hosting transition and PyPI
access.  If no maintainer is available, give access to the Flask core team.</li>
<li>An approved Flask extension must provide exactly one package or module
named <code class="docutils literal"><span class="pre">flask_extensionname</span></code>.</li>
<li>It must ship a testing suite that can either be invoked with <code class="docutils literal"><span class="pre">make</span> <span class="pre">test</span></code>
or <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">test</span></code>.  For test suites invoked with <code class="docutils literal"><span class="pre">make</span>
<span class="pre">test</span></code> the extension has to ensure that all dependencies for the test
are installed automatically.  If tests are invoked with <code class="docutils literal"><span class="pre">python</span> <span class="pre">setup.py</span>
<span class="pre">test</span></code>, test dependencies can be specified in the <code class="file docutils literal"><span class="pre">setup.py</span></code> file.  The
test suite also has to be part of the distribution.</li>
<li>APIs of approved extensions will be checked for the following
characteristics:<ul>
<li>an approved extension has to support multiple applications
running in the same Python process.</li>
<li>it must be possible to use the factory pattern for creating
applications.</li>
</ul>
</li>
<li>The license must be BSD/MIT/WTFPL licensed.</li>
<li>The naming scheme for official extensions is <em>Flask-ExtensionName</em> or
<em>ExtensionName-Flask</em>.</li>
<li>Approved extensions must define all their dependencies in the
<code class="file docutils literal"><span class="pre">setup.py</span></code> file unless a dependency cannot be met because it is not
available on PyPI.</li>
<li>The extension must have documentation that uses one of the two Flask
themes for Sphinx documentation.</li>
<li>The setup.py description (and thus the PyPI description) has to
link to the documentation, website (if there is one) and there
must be a link to automatically install the development version
(<code class="docutils literal"><span class="pre">PackageName==dev</span></code>).</li>
<li>The <code class="docutils literal"><span class="pre">zip_safe</span></code> flag in the setup script must be set to <code class="docutils literal"><span class="pre">False</span></code>,
even if the extension would be safe for zipping.</li>
<li>An extension currently has to support Python 2.6 as well as
Python 2.7</li>
</ol>
</div>
<div class="section" id="extension-import-transition">
<span id="ext-import-transition"></span><h2>5.9. Extension Import Transition<a class="headerlink" href="#extension-import-transition" title="Permalink to this headline">Â¶</a></h2>
<p>In early versions of Flask we recommended using namespace packages for Flask
extensions, of the form <code class="docutils literal"><span class="pre">flaskext.foo</span></code>. This turned out to be problematic in
practice because it meant that multiple <code class="docutils literal"><span class="pre">flaskext</span></code> packages coexist.
Consequently we have recommended to name extensions <code class="docutils literal"><span class="pre">flask_foo</span></code> over
<code class="docutils literal"><span class="pre">flaskext.foo</span></code> for a long time.</p>
<p>Flask 0.8 introduced a redirect import system as a compatibility aid for app
developers: Importing <code class="docutils literal"><span class="pre">flask.ext.foo</span></code> would try <code class="docutils literal"><span class="pre">flask_foo</span></code> and
<code class="docutils literal"><span class="pre">flaskext.foo</span></code> in that order.</p>
<p>As of Flask 0.11, most Flask extensions have transitioned to the new naming
schema. The <code class="docutils literal"><span class="pre">flask.ext.foo</span></code> compatibility alias is still in Flask 0.11 but is
now deprecated &#8211; you should use <code class="docutils literal"><span class="pre">flask_foo</span></code>.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="flask_doc.styleguide.html" class="btn btn-neutral float-right" title="6. Pocoo Styleguide" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="flask_doc.unicode.html" class="btn btn-neutral" title="4. Unicode in Flask" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>