

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Werkzeug Tutorial &mdash; Flask API</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Flask API" href="index.html"/>
        <link rel="up" title="Werkzeug doc materials" href="werk_doc.html"/>
        <link rel="next" title="2. Quickstart" href="werk_doc.quickstart.html"/>
        <link rel="prev" title="Werkzeug doc materials" href="werk_doc.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Flask API
          

          
          </a>

          
            
            
              <div class="version">
                1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="flask_doc.html">Flask doc materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.foreword.html">1. Foreword</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#what-does-micro-mean">1.1. What does &#8220;micro&#8221; mean?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#configuration-and-conventions">1.2. Configuration and Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#growing-with-flask">1.3. Growing with Flask</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.advanced_foreword.html">2. Foreword for Experienced Programmers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#thread-locals-in-flask">2.1. Thread-Locals in Flask</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#develop-for-the-web-with-caution">2.2. Develop for the Web with Caution</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#python-3-support-in-flask">2.3. Python 3 Support in Flask</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.installation.html">3. Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#virtualenv">3.1. virtualenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#system-wide-installation">3.2. System-Wide Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#living-on-the-edge">3.3. Living on the Edge</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#pip-and-setuptools-on-windows">3.4. <cite>pip</cite> and <cite>setuptools</cite> on Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.quickstart.html">4. Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#a-minimal-application">4.1. A Minimal Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#what-to-do-if-the-server-does-not-start">4.2. What to do if the Server does not Start</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#old-version-of-flask">4.2.1. Old Version of Flask</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#invalid-import-name">4.2.2. Invalid Import Name</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#debug-mode">4.3. Debug Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#routing">4.4. Routing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#variable-rules">4.4.1. Variable Rules</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#url-building">4.4.2. URL Building</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#http-methods">4.4.3. HTTP Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#static-files">4.5. Static Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#rendering-templates">4.6. Rendering Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#accessing-request-data">4.7. Accessing Request Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#context-locals">4.7.1. Context Locals</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#the-request-object">4.7.2. The Request Object</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#file-uploads">4.7.3. File Uploads</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.quickstart.html#cookies">4.7.4. Cookies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#redirects-and-errors">4.8. Redirects and Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#about-responses">4.9. About Responses</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#sessions">4.10. Sessions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#message-flashing">4.11. Message Flashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#logging">4.12. Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#hooking-in-wsgi-middlewares">4.13. Hooking in WSGI Middlewares</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#using-flask-extensions">4.14. Using Flask Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.quickstart.html#deploying-to-a-web-server">4.15. Deploying to a Web Server</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.tutorial.html">5. TODO - Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html">6. Templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.templating.html#jinja-setup">6.1. Jinja Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.templating.html#standard-context">6.2. Standard Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.templating.html#standard-filters">6.3. Standard Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.templating.html#controlling-autoescaping">6.4. Controlling Autoescaping</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.templating.html#registering-filters">6.5. Registering Filters</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.templating.html#context-processors">6.6. Context Processors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html">7. Testing Flask Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#the-application">7.1. The Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#the-testing-skeleton">7.2. The Testing Skeleton</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#the-first-test">7.3. The First Test</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#logging-in-and-out">7.4. Logging In and Out</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#test-adding-messages">7.5. Test Adding Messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#other-testing-tricks">7.6. Other Testing Tricks</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#faking-resources-and-context">7.7. Faking Resources and Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#keeping-the-context-around">7.8. Keeping the Context Around</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.testing.html#accessing-and-modifying-sessions">7.9. Accessing and Modifying Sessions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.errorhandling.html">8. Application Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-logging-tools">8.1. Error Logging Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-handlers">8.2. Error handlers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#registering">8.2.1. Registering</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#handling">8.2.2. Handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-mails">8.3. Error Mails</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#logging-to-a-file">8.4. Logging to a File</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#controlling-the-log-format">8.5. Controlling the Log Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#email">8.5.1. Email</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#file-logging">8.5.2. File logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#complex-log-formatting">8.5.3. Complex Log Formatting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#other-libraries">8.6. Other Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.errorhandling.html#debugging-application-errors">9. Debugging Application Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#when-in-doubt-run-manually">9.1. When in Doubt, Run Manually</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#working-with-debuggers">9.2. Working with Debuggers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html">10. Configuration Handling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.config.html#configuration-basics">10.1. Configuration Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.config.html#builtin-configuration-values">10.2. Builtin Configuration Values</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.config.html#configuring-from-files">10.3. Configuring from Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.config.html#configuration-best-practices">10.4. Configuration Best Practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.config.html#development-production">10.5. Development / Production</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.config.html#instance-folders">10.6. Instance Folders</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.signals.html">11. Signals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#subscribing-to-signals">11.1. Subscribing to Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#creating-signals">11.2. Creating Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#sending-signals">11.3. Sending Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#signals-and-flask-s-request-context">11.4. Signals and Flask&#8217;s Request Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#decorator-based-signal-subscriptions">11.5. Decorator Based Signal Subscriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#core-signals">11.6. Core Signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.views.html">12. Pluggable Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#basic-principle">12.1. Basic Principle</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-hints">12.2. Method Hints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-based-dispatching">12.3. Method Based Dispatching</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#decorating-views">12.4. Decorating Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-views-for-apis">12.5. Method Views for APIs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.appcontext.html">13. The Application Context</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#purpose-of-the-application-context">13.1. Purpose of the Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#creating-an-application-context">13.2. Creating an Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#locality-of-the-context">13.3. Locality of the Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#context-usage">13.4. Context Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.reqcontext.html">14. The Request Context</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#diving-into-context-locals">14.1. Diving into Context Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#how-the-context-works">14.2. How the Context Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#callbacks-and-errors">14.3. Callbacks and Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#teardown-callbacks">14.4. Teardown Callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#notes-on-proxies">14.5. Notes On Proxies</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.reqcontext.html#context-preservation-on-error">14.6. Context Preservation on Error</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.blueprints.html">15. Modular Applications with Blueprints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#why-blueprints">15.1. Why Blueprints?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#the-concept-of-blueprints">15.2. The Concept of Blueprints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#my-first-blueprint">15.3. My First Blueprint</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#registering-blueprints">15.4. Registering Blueprints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#blueprint-resources">15.5. Blueprint Resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#blueprint-resource-folder">15.5.1. Blueprint Resource Folder</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#static-files">15.5.2. Static Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#templates">15.5.3. Templates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#building-urls">15.6. Building URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#error-handlers">15.7. Error Handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.extensions.html">16. Flask Extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#finding-extensions">16.1. Finding Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#using-extensions">16.2. Using Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#building-extensions">16.3. Building Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#flask-before-0-8">16.4. Flask Before 0.8</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.cli.html">17. Command Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#basic-usage">17.1. Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#virtualenv-integration">17.2. Virtualenv Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#debug-flag">17.3. Debug Flag</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#running-a-shell">17.4. Running a Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#custom-commands">17.5. Custom Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#application-context">17.6. Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#factory-functions">17.7. Factory Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#custom-scripts">17.8. Custom Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#cli-plugins">17.9. CLI Plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.server.html">18. Development Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.server.html#command-line">18.1. Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.server.html#in-code">18.2. In Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.shell.html">19. Working with the Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#command-line-interface">19.1. Command Line Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#creating-a-request-context">19.2. Creating a Request Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#firing-before-after-request">19.3. Firing Before/After Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#further-improving-the-shell-experience">19.4. Further Improving the Shell Experience</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.patterns.html">20. TODO - PATTERNS</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.deploying.html">21. TODO - Deployment Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.becomingbig.html">22. Becoming Big</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#read-the-source">22.1. Read the Source.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#hook-extend">22.2. Hook. Extend.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#subclass">22.3. Subclass.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#wrap-with-middleware">22.4. Wrap with middleware.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#fork">22.5. Fork.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#scale-like-a-pro">22.6. Scale like a pro.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#discuss-with-the-community">22.7. Discuss with the community.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc2.html">Flask doc &#8212; Additional Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.design.html">1. Design Decisions in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#the-explicit-application-object">1.1. The Explicit Application Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#the-routing-system">1.2. The Routing System</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#one-template-engine">1.3. One Template Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#micro-with-dependencies">1.4. Micro with Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#thread-locals">1.5. Thread Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#what-flask-is-what-flask-is-not">1.6. What Flask is, What Flask is Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.htmlfaq.html">2. HTML/XHTML FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#history-of-xhtml">2.1. History of XHTML</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#history-of-html5">2.2. History of HTML5</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#html-versus-xhtml">2.3. HTML versus XHTML</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#what-does-strict-mean">2.4. What does &#8220;strict&#8221; mean?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#new-technologies-in-html5">2.5. New technologies in HTML5</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#what-should-be-used">2.6. What should be used?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.security.html">3. Security Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#cross-site-scripting-xss">3.1. Cross-Site Scripting (XSS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#cross-site-request-forgery-csrf">3.2. Cross-Site Request Forgery (CSRF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#json-security">3.3. JSON Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.unicode.html">4. Unicode in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#automatic-conversion">4.1. Automatic Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#the-golden-rule">4.2. The Golden Rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#encoding-and-decoding-yourself">4.3. Encoding and Decoding Yourself</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#configuring-editors">4.4. Configuring Editors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.extensiondev.html">5. Flask Extension Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#anatomy-of-an-extension">5.1. Anatomy of an Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#hello-flaskext">5.2. &#8220;Hello Flaskext!&#8221;</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.extensiondev.html#setup-py">5.2.1. setup.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.extensiondev.html#flask-sqlite3-py">5.2.2. flask_sqlite3.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#initializing-extensions">5.3. Initializing Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#the-extension-code">5.4. The Extension Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#using-app-ctx-stack">5.5. Using _app_ctx_stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#teardown-behavior">5.6. Teardown Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#learn-from-others">5.7. Learn from Others</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#approved-extensions">5.8. Approved Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#extension-import-transition">5.9. Extension Import Transition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.styleguide.html">6. Pocoo Styleguide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#general-layout">6.1. General Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#expressions-and-statements">6.2. Expressions and Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#naming-conventions">6.3. Naming Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#docstrings">6.4. Docstrings</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#comments">6.5. Comments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="werk_doc.html">Werkzeug doc materials</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">1. Werkzeug Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introducing-shortly">1.1. Introducing Shortly</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-0-a-basic-wsgi-introduction">1.2. Step 0: A Basic WSGI Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-1-creating-the-folders">1.3. Step 1: Creating the Folders</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-2-the-base-structure">1.4. Step 2: The Base Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#intermezzo-running-the-application">1.5. Intermezzo: Running the Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-3-the-environment">1.6. Step 3: The Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-4-the-routing">1.7. Step 4: The Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-5-the-first-view">1.8. Step 5: The First View</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-6-redirect-view">1.9. Step 6: Redirect View</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-7-detail-view">1.10. Step 7: Detail View</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-8-templates">1.11. Step 8: Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-9-the-style">1.12. Step 9: The Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bonus-refinements">1.13. Bonus: Refinements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.quickstart.html">2. Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#wsgi-environment">2.1. WSGI Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#enter-request">2.2. Enter Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#header-parsing">2.3. Header Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#responses">2.4. Responses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.deployment.html">3. Application Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.cgi.html">3.1. CGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.cgi.html#creating-a-cgi-file">3.1.1. Creating a <cite>.cgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.cgi.html#server-setup">3.1.2. Server Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html">3.2. <cite>mod_wsgi</cite> (Apache)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#installing-mod-wsgi">3.2.1. Installing <cite>mod_wsgi</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#creating-a-wsgi-file">3.2.2. Creating a <cite>.wsgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#configuring-apache">3.2.3. Configuring Apache</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.fastcgi.html">3.3. FastCGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#creating-a-fcgi-file">3.3.1. Creating a <cite>.fcgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#configuring-lighttpd">3.3.2. Configuring lighttpd</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#configuring-nginx">3.3.3. Configuring nginx</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#debugging">3.3.4. Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.proxying.html">3.4. HTTP Proxying</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.proxying.html#creating-a-py-server">3.4.1. Creating a <cite>.py</cite> server</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.proxying.html#configuring-nginx">3.4.2. Configuring nginx</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="generated/flask.html">flask</a><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/flask.html#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.after_this_request.html">flask.after_this_request</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.copy_current_request_context.html">flask.copy_current_request_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.escape.html">flask.escape</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.flash.html">flask.flash</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.get_flashed_messages.html">flask.get_flashed_messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.get_template_attribute.html">flask.get_template_attribute</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.has_app_context.html">flask.has_app_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.has_request_context.html">flask.has_request_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.jsonify.html">flask.jsonify</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.make_response.html">flask.make_response</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.redirect.html">flask.redirect</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.render_template.html">flask.render_template</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.render_template_string.html">flask.render_template_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.safe_join.html">flask.safe_join</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.send_file.html">flask.send_file</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.send_from_directory.html">flask.send_from_directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.stream_with_context.html">flask.stream_with_context</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/flask.url_for.html">flask.url_for</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="generated/flask.html#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/flask.Blueprint.html">flask.Blueprint</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Blueprint.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Blueprint.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/flask.Config.html">flask.Config</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Config.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/flask.Flask.html">flask.Flask</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Flask.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Flask.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/flask.Markup.html">flask.Markup</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Markup.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/flask.Request.html">flask.Request</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Request.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Request.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/flask.Response.html">flask.Response</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Response.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Response.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/flask.Session.html">flask.Session</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Session.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/flask.Session.html#attributes">Attributes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="generated/werkzeug.html">werkzeug</a><ul>
<li class="toctree-l2"><a class="reference internal" href="generated/werkzeug.html#functions">Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.append_slash_redirect.html">werkzeug.append_slash_redirect</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.bind_arguments.html">werkzeug.bind_arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.check_password_hash.html">werkzeug.check_password_hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.cookie_date.html">werkzeug.cookie_date</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.create_environ.html">werkzeug.create_environ</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.dump_cookie.html">werkzeug.dump_cookie</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.dump_header.html">werkzeug.dump_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.dump_options_header.html">werkzeug.dump_options_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.escape.html">werkzeug.escape</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.extract_path_info.html">werkzeug.extract_path_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.find_modules.html">werkzeug.find_modules</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.format_string.html">werkzeug.format_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.generate_etag.html">werkzeug.generate_etag</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.generate_password_hash.html">werkzeug.generate_password_hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.get_current_url.html">werkzeug.get_current_url</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.get_host.html">werkzeug.get_host</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.http_date.html">werkzeug.http_date</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.import_string.html">werkzeug.import_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.iri_to_uri.html">werkzeug.iri_to_uri</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.is_entity_header.html">werkzeug.is_entity_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.is_hop_by_hop_header.html">werkzeug.is_hop_by_hop_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.is_resource_modified.html">werkzeug.is_resource_modified</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.make_line_iter.html">werkzeug.make_line_iter</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_accept_header.html">werkzeug.parse_accept_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_authorization_header.html">werkzeug.parse_authorization_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_cache_control_header.html">werkzeug.parse_cache_control_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_cookie.html">werkzeug.parse_cookie</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_date.html">werkzeug.parse_date</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_dict_header.html">werkzeug.parse_dict_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_etags.html">werkzeug.parse_etags</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_form_data.html">werkzeug.parse_form_data</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_list_header.html">werkzeug.parse_list_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_options_header.html">werkzeug.parse_options_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_set_header.html">werkzeug.parse_set_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.parse_www_authenticate_header.html">werkzeug.parse_www_authenticate_header</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.peek_path_info.html">werkzeug.peek_path_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.pop_path_info.html">werkzeug.pop_path_info</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.quote_etag.html">werkzeug.quote_etag</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.quote_header_value.html">werkzeug.quote_header_value</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.redirect.html">werkzeug.redirect</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.release_local.html">werkzeug.release_local</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.remove_entity_headers.html">werkzeug.remove_entity_headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.remove_hop_by_hop_headers.html">werkzeug.remove_hop_by_hop_headers</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.responder.html">werkzeug.responder</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.run_simple.html">werkzeug.run_simple</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.run_wsgi_app.html">werkzeug.run_wsgi_app</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.secure_filename.html">werkzeug.secure_filename</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.test_app.html">werkzeug.test_app</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.unescape.html">werkzeug.unescape</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.unquote_etag.html">werkzeug.unquote_etag</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.unquote_header_value.html">werkzeug.unquote_header_value</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.uri_to_iri.html">werkzeug.uri_to_iri</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.url_decode.html">werkzeug.url_decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.url_encode.html">werkzeug.url_encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.url_fix.html">werkzeug.url_fix</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.url_quote.html">werkzeug.url_quote</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.url_quote_plus.html">werkzeug.url_quote_plus</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.url_unquote.html">werkzeug.url_unquote</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.url_unquote_plus.html">werkzeug.url_unquote_plus</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.validate_arguments.html">werkzeug.validate_arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.wrap_file.html">werkzeug.wrap_file</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="generated/werkzeug.html#classes">Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Aborter.html">werkzeug.Aborter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Aborter.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Accept.html">werkzeug.Accept</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Accept.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Accept.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.AcceptMixin.html">werkzeug.AcceptMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.AcceptMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Authorization.html">werkzeug.Authorization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Authorization.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Authorization.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.AuthorizationMixin.html">werkzeug.AuthorizationMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.AuthorizationMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.BaseRequest.html">werkzeug.BaseRequest</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.BaseRequest.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.BaseRequest.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.BaseResponse.html">werkzeug.BaseResponse</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.BaseResponse.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.BaseResponse.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.CallbackDict.html">werkzeug.CallbackDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.CallbackDict.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.CallbackDict.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.CharsetAccept.html">werkzeug.CharsetAccept</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.CharsetAccept.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.CharsetAccept.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Client.html">werkzeug.Client</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Client.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ClosingIterator.html">werkzeug.ClosingIterator</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ClosingIterator.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.CombinedMultiDict.html">werkzeug.CombinedMultiDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.CombinedMultiDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.CommonRequestDescriptorsMixin.html">werkzeug.CommonRequestDescriptorsMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.CommonRequestDescriptorsMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.CommonResponseDescriptorsMixin.html">werkzeug.CommonResponseDescriptorsMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.CommonResponseDescriptorsMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.DebuggedApplication.html">werkzeug.DebuggedApplication</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.DebuggedApplication.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.DebuggedApplication.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.DispatcherMiddleware.html">werkzeug.DispatcherMiddleware</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.DispatcherMiddleware.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ETagRequestMixin.html">werkzeug.ETagRequestMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ETagRequestMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ETagResponseMixin.html">werkzeug.ETagResponseMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ETagResponseMixin.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ETagResponseMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ETags.html">werkzeug.ETags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ETags.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.EnvironBuilder.html">werkzeug.EnvironBuilder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.EnvironBuilder.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.EnvironBuilder.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.EnvironHeaders.html">werkzeug.EnvironHeaders</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.EnvironHeaders.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.FileMultiDict.html">werkzeug.FileMultiDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.FileMultiDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.FileStorage.html">werkzeug.FileStorage</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.FileStorage.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.FileStorage.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.FileWrapper.html">werkzeug.FileWrapper</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.FileWrapper.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.HTMLBuilder.html">werkzeug.HTMLBuilder</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.HTMLBuilder.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.HeaderSet.html">werkzeug.HeaderSet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.HeaderSet.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Headers.html">werkzeug.Headers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Headers.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Href.html">werkzeug.Href</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Href.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ImmutableDict.html">werkzeug.ImmutableDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ImmutableDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ImmutableList.html">werkzeug.ImmutableList</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ImmutableList.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ImmutableMultiDict.html">werkzeug.ImmutableMultiDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ImmutableMultiDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ImmutableOrderedMultiDict.html">werkzeug.ImmutableOrderedMultiDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ImmutableOrderedMultiDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ImmutableTypeConversionDict.html">werkzeug.ImmutableTypeConversionDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ImmutableTypeConversionDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.LanguageAccept.html">werkzeug.LanguageAccept</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LanguageAccept.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LanguageAccept.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.LimitedStream.html">werkzeug.LimitedStream</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LimitedStream.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LimitedStream.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Local.html">werkzeug.Local</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Local.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.LocalManager.html">werkzeug.LocalManager</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LocalManager.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.LocalProxy.html">werkzeug.LocalProxy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LocalProxy.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.LocalStack.html">werkzeug.LocalStack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LocalStack.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.LocalStack.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.MIMEAccept.html">werkzeug.MIMEAccept</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.MIMEAccept.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.MIMEAccept.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.MultiDict.html">werkzeug.MultiDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.MultiDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.OrderedMultiDict.html">werkzeug.OrderedMultiDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.OrderedMultiDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Request.html">werkzeug.Request</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Request.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Request.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.RequestCacheControl.html">werkzeug.RequestCacheControl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.RequestCacheControl.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.RequestCacheControl.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.Response.html">werkzeug.Response</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Response.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.Response.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ResponseCacheControl.html">werkzeug.ResponseCacheControl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ResponseCacheControl.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ResponseCacheControl.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.ResponseStreamMixin.html">werkzeug.ResponseStreamMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.ResponseStreamMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.SharedDataMiddleware.html">werkzeug.SharedDataMiddleware</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.SharedDataMiddleware.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.TypeConversionDict.html">werkzeug.TypeConversionDict</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.TypeConversionDict.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.UserAgent.html">werkzeug.UserAgent</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.UserAgent.html#methods">Methods</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.UserAgentMixin.html">werkzeug.UserAgentMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.UserAgentMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.WWWAuthenticate.html">werkzeug.WWWAuthenticate</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.WWWAuthenticate.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.WWWAuthenticate.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.WWWAuthenticateMixin.html">werkzeug.WWWAuthenticateMixin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.WWWAuthenticateMixin.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.cached_property.html">werkzeug.cached_property</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.cached_property.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.cached_property.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.environ_property.html">werkzeug.environ_property</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.environ_property.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.environ_property.html#attributes">Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="generated/generated/werkzeug.header_property.html">werkzeug.header_property</a><ul>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.header_property.html#methods">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="generated/generated/werkzeug.header_property.html#attributes">Attributes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="generated/werkzeug.html#exceptions">Exceptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/werkzeug.ArgumentValidationError.html">werkzeug.ArgumentValidationError</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flask API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="werk_doc.html">Werkzeug doc materials</a> &raquo;</li>
        
      <li>1. Werkzeug Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/werk_doc.tutorial.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-werkzeug">
<span id="werkzeug-tutorial"></span><h1>1. Werkzeug Tutorial<a class="headerlink" href="#module-werkzeug" title="Permalink to this headline"></a></h1>
<p>Welcome to the Werkzeug tutorial in which we will create a <a class="reference external" href="http://tinyurl.com/">TinyURL</a> clone
that stores URLs in a redis instance.  The libraries we will use for this
applications are <a class="reference external" href="http://jinja.pocoo.org/">Jinja</a> 2 for the templates, <a class="reference external" href="http://redis.io/">redis</a> for the database
layer and, of course, Werkzeug for the WSGI layer.</p>
<p>You can use <cite>pip</cite> to install the required libraries:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>pip install Jinja2 redis Werkzeug
</pre></div>
</div>
<p>Also make sure to have a redis server running on your local machine.  If
you are on OS X, you can use <cite>brew</cite> to install it:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>brew install redis
</pre></div>
</div>
<p>If you are on Ubuntu or Debian, you can use apt-get:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>sudo apt-get install redis-server
</pre></div>
</div>
<p>Redis was developed for UNIX systems and was never really designed to
work on Windows.  For development purposes, the unofficial ports however
work well enough.  You can get them from <a class="reference external" href="https://github.com/dmajkic/redis/downloads">github</a>.</p>
<div class="section" id="introducing-shortly">
<h2>1.1. Introducing Shortly<a class="headerlink" href="#introducing-shortly" title="Permalink to this headline"></a></h2>
<p>In this tutorial, we will together create a simple URL shortener service
with Werkzeug.  Please keep in mind that Werkzeug is not a framework, it&#8217;s
a library with utilities to create your own framework or application and
as such is very flexible.  The approach we use here is just one of many you
can use.</p>
<p>As data store, we will use <a class="reference external" href="http://redis.io/">redis</a> here instead of a relational database
to keep this simple and because that&#8217;s the kind of job that <a class="reference external" href="http://redis.io/">redis</a>
excels at.</p>
<p>The final result will look something like this:</p>
<img alt="a screenshot of shortly" src="_images/shortly.png" />
</div>
<div class="section" id="step-0-a-basic-wsgi-introduction">
<h2>1.2. Step 0: A Basic WSGI Introduction<a class="headerlink" href="#step-0-a-basic-wsgi-introduction" title="Permalink to this headline"></a></h2>
<p>Werkzeug is a utility library for WSGI.  WSGI itself is a protocol or
convention that ensures that your web application can speak with the
webserver and more importantly that web applications work nicely together.</p>
<p>A basic Hello World application in WSGI without the help of Werkzeug
looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">start_response</span><span class="p">(</span><span class="s1">&#39;200 OK&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">,</span> <span class="s1">&#39;text/plain&#39;</span><span class="p">)])</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>A WSGI application is something you can call and pass an environ dict
and a <code class="docutils literal"><span class="pre">start_response</span></code> callable.  The environ contains all incoming
information, the <code class="docutils literal"><span class="pre">start_response</span></code> function can be used to indicate the
start of the response.  With Werkzeug you don&#8217;t have to deal directly with
either as request and response objects are provided to work with them.</p>
<p>The request data takes the environ object and allows you to access the
data from that environ in a nice manner.  The response object is a WSGI
application in itself and provides a much nicer way to create responses.</p>
<p>Here is how you would write that application with response objects:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">werkzeug.wrappers</span> <span class="kn">import</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
<p>And here an expanded version that looks at the query string in the URL
(more importantly at the <cite>name</cite> parameter in the URL to substitute World
against another word):</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">werkzeug.wrappers</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">Response</span>

<span class="k">def</span> <span class="nf">application</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
    <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
    <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Hello </span><span class="si">%s</span><span class="s1">!&#39;</span> <span class="o">%</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;World&#39;</span><span class="p">)</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">Response</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">mimetype</span><span class="o">=</span><span class="s1">&#39;text/plain&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
<p>And that&#8217;s all you need to know about WSGI.</p>
</div>
<div class="section" id="step-1-creating-the-folders">
<h2>1.3. Step 1: Creating the Folders<a class="headerlink" href="#step-1-creating-the-folders" title="Permalink to this headline"></a></h2>
<p>Before we get started, lets create the folders needed for this application:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>/shortly
    /static
    /templates
</pre></div>
</div>
<p>The shortly folder is not a python package, but just something where we
drop our files.  Directly into this folder we will then put our main
module in the following steps. The files inside the static folder are
available to users of the application via HTTP.  This is the place where
CSS and JavaScript files go. Inside the templates folder we will make
Jinja2 look for templates.  The templates you create later in the tutorial
will go in this directory.</p>
</div>
<div class="section" id="step-2-the-base-structure">
<h2>1.4. Step 2: The Base Structure<a class="headerlink" href="#step-2-the-base-structure" title="Permalink to this headline"></a></h2>
<p>Now let&#8217;s get right into it and create a module for our application.  Let&#8217;s
create a file called <cite>shortly.py</cite> in the <cite>shortly</cite> folder.  At first we
will need a bunch of imports.  I will pull in all the imports here, even
if they are not used right away, to keep it from being confusing:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">redis</span>
<span class="kn">import</span> <span class="nn">urlparse</span>
<span class="kn">from</span> <span class="nn">werkzeug.wrappers</span> <span class="kn">import</span> <span class="n">Request</span><span class="p">,</span> <span class="n">Response</span>
<span class="kn">from</span> <span class="nn">werkzeug.routing</span> <span class="kn">import</span> <span class="n">Map</span><span class="p">,</span> <span class="n">Rule</span>
<span class="kn">from</span> <span class="nn">werkzeug.exceptions</span> <span class="kn">import</span> <span class="n">HTTPException</span><span class="p">,</span> <span class="n">NotFound</span>
<span class="kn">from</span> <span class="nn">werkzeug.wsgi</span> <span class="kn">import</span> <span class="n">SharedDataMiddleware</span>
<span class="kn">from</span> <span class="nn">werkzeug.utils</span> <span class="kn">import</span> <span class="n">redirect</span>
<span class="kn">from</span> <span class="nn">jinja2</span> <span class="kn">import</span> <span class="n">Environment</span><span class="p">,</span> <span class="n">FileSystemLoader</span>
</pre></div>
</div>
<p>Then we can create the basic structure for our application and a function
to create a new instance of it, optionally with a piece of WSGI middleware
that exports all the files on the <cite>static</cite> folder on the web:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Shortly</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;redis_host&#39;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;redis_port&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s1">&#39;Hello World!&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">wsgi_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">environ</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dispatch_request</span><span class="p">(</span><span class="n">request</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">create_app</span><span class="p">(</span><span class="n">redis_host</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span> <span class="n">redis_port</span><span class="o">=</span><span class="mi">6379</span><span class="p">,</span> <span class="n">with_static</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">Shortly</span><span class="p">({</span>
        <span class="s1">&#39;redis_host&#39;</span><span class="p">:</span>       <span class="n">redis_host</span><span class="p">,</span>
        <span class="s1">&#39;redis_port&#39;</span><span class="p">:</span>       <span class="n">redis_port</span>
    <span class="p">})</span>
    <span class="k">if</span> <span class="n">with_static</span><span class="p">:</span>
        <span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span> <span class="o">=</span> <span class="n">SharedDataMiddleware</span><span class="p">(</span><span class="n">app</span><span class="o">.</span><span class="n">wsgi_app</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;/static&#39;</span><span class="p">:</span>  <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s1">&#39;static&#39;</span><span class="p">)</span>
        <span class="p">})</span>
    <span class="k">return</span> <span class="n">app</span>
</pre></div>
</div>
<p>Lastly we can add a piece of code that will start a local development
server with automatic code reloading and a debugger:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">werkzeug.serving</span> <span class="kn">import</span> <span class="n">run_simple</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">create_app</span><span class="p">()</span>
    <span class="n">run_simple</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">app</span><span class="p">,</span> <span class="n">use_debugger</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">use_reloader</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The basic idea here is that our <code class="docutils literal"><span class="pre">Shortly</span></code> class is an actual WSGI
application.  The <code class="docutils literal"><span class="pre">__call__</span></code> method directly dispatches to <code class="docutils literal"><span class="pre">wsgi_app</span></code>.
This is done so that we can wrap <code class="docutils literal"><span class="pre">wsgi_app</span></code> to apply middlewares like we
do in the <code class="docutils literal"><span class="pre">create_app</span></code> function.  The actual <code class="docutils literal"><span class="pre">wsgi_app</span></code> method then
creates a <a class="reference internal" href="generated/generated/werkzeug.Request.html#werkzeug.Request" title="werkzeug.Request"><code class="xref py py-class docutils literal"><span class="pre">Request</span></code></a> object and calls the <code class="docutils literal"><span class="pre">dispatch_request</span></code>
method which then has to return a <a class="reference internal" href="generated/generated/werkzeug.Response.html#werkzeug.Response" title="werkzeug.Response"><code class="xref py py-class docutils literal"><span class="pre">Response</span></code></a> object which is then
evaluated as WSGI application again.  As you can see: turtles all the way
down.  Both the <code class="docutils literal"><span class="pre">Shortly</span></code> class we create, as well as any request object
in Werkzeug implements the WSGI interface.  As a result of that you could
even return another WSGI application from the <code class="docutils literal"><span class="pre">dispatch_request</span></code> method.</p>
<p>The <code class="docutils literal"><span class="pre">create_app</span></code> factory function can be used to create a new instance
of our application.  Not only will it pass some parameters as
configuration to the application but also optionally add a WSGI middleware
that exports static files.  This way we have access to the files from the
static folder even when we are not configuring our server to provide them
which is very helpful for development.</p>
</div>
<div class="section" id="intermezzo-running-the-application">
<h2>1.5. Intermezzo: Running the Application<a class="headerlink" href="#intermezzo-running-the-application" title="Permalink to this headline"></a></h2>
<p>Now you should be able to execute the file with <cite>python</cite> and see a server
on your local machine:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span>$ python shortly.py
 * Running on http://127.0.0.1:5000/
 * Restarting with reloader: stat() polling
</pre></div>
</div>
<p>It also tells you that the reloader is active.  It will use various
techniques to figure out if any file changed on the disk and then
automatically restart.</p>
<p>Just go to the URL and you should see Hello World!.</p>
</div>
<div class="section" id="step-3-the-environment">
<h2>1.6. Step 3: The Environment<a class="headerlink" href="#step-3-the-environment" title="Permalink to this headline"></a></h2>
<p>Now that we have the basic application class, we can make the constructor
do something useful and provide a few helpers on there that can come in
handy.  We will need to be able to render templates and connect to redis,
so let&#8217;s extend the class a bit:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">redis</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;redis_host&#39;</span><span class="p">],</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;redis_port&#39;</span><span class="p">])</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">__file__</span><span class="p">),</span> <span class="s1">&#39;templates&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">jinja_env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="n">template_path</span><span class="p">),</span>
                                 <span class="n">autoescape</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">render_template</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template_name</span><span class="p">,</span> <span class="o">**</span><span class="n">context</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">jinja_env</span><span class="o">.</span><span class="n">get_template</span><span class="p">(</span><span class="n">template_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">context</span><span class="p">),</span> <span class="n">mimetype</span><span class="o">=</span><span class="s1">&#39;text/html&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="step-4-the-routing">
<h2>1.7. Step 4: The Routing<a class="headerlink" href="#step-4-the-routing" title="Permalink to this headline"></a></h2>
<p>Next up is routing.  Routing is the process of matching and parsing the URL to
something we can use.  Werkzeug provides a flexible integrated routing
system which we can use for that.  The way it works is that you create a
<code class="xref py py-class docutils literal"><span class="pre">Map</span></code> instance and add a bunch of
<code class="xref py py-class docutils literal"><span class="pre">Rule</span></code> objects.  Each rule has a pattern it will
try to match the URL against and an endpoint.  The endpoint is typically
a string and can be used to uniquely identify the URL.  We could also use
this to automatically reverse the URL, but that&#8217;s not what we will do in this
tutorial.</p>
<p>Just put this into the constructor:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="bp">self</span><span class="o">.</span><span class="n">url_map</span> <span class="o">=</span> <span class="n">Map</span><span class="p">([</span>
    <span class="n">Rule</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;new_url&#39;</span><span class="p">),</span>
    <span class="n">Rule</span><span class="p">(</span><span class="s1">&#39;/&lt;short_id&gt;&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;follow_short_link&#39;</span><span class="p">),</span>
    <span class="n">Rule</span><span class="p">(</span><span class="s1">&#39;/&lt;short_id&gt;+&#39;</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="s1">&#39;short_link_details&#39;</span><span class="p">)</span>
<span class="p">])</span>
</pre></div>
</div>
<p>Here we create a URL map with three rules.  <code class="docutils literal"><span class="pre">/</span></code> for the root of the URL
space where we will just dispatch to a function that implements the logic
to create a new URL.  And then one that follows the short link to the
target URL and another one with the same rule but a plus (<code class="docutils literal"><span class="pre">+</span></code>) at the
end to show the link details.</p>
<p>So how do we find our way from the endpoint to a function?  That&#8217;s up to you.
The way we will do it in this tutorial is by calling the method <code class="docutils literal"><span class="pre">on_</span></code>
+ endpoint on the class itself.  Here is how this works:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dispatch_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="n">adapter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">url_map</span><span class="o">.</span><span class="n">bind_to_environ</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">environ</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">endpoint</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="n">adapter</span><span class="o">.</span><span class="n">match</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;on_&#39;</span> <span class="o">+</span> <span class="n">endpoint</span><span class="p">)(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">values</span><span class="p">)</span>
    <span class="k">except</span> <span class="n">HTTPException</span><span class="p">,</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">e</span>
</pre></div>
</div>
<p>We bind the URL map to the current environment and get back a
<code class="xref py py-class docutils literal"><span class="pre">URLAdapter</span></code>.  The adapter can be used to match
the request but also to reverse URLs.  The match method will return the
endpoint and a dictionary of values in the URL.  For instance the rule for
<code class="docutils literal"><span class="pre">follow_short_link</span></code> has a variable part called <code class="docutils literal"><span class="pre">short_id</span></code>.  When we go
to <code class="docutils literal"><span class="pre">http://localhost:5000/foo</span></code> we will get the following values back:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">endpoint</span> <span class="o">=</span> <span class="s1">&#39;follow_short_link&#39;</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;short_id&#39;</span><span class="p">:</span> <span class="s1">u&#39;foo&#39;</span><span class="p">}</span>
</pre></div>
</div>
<p>If it does not match anything, it will raise a
<code class="xref py py-exc docutils literal"><span class="pre">NotFound</span></code> exception, which is an
<code class="xref py py-exc docutils literal"><span class="pre">HTTPException</span></code>.  All HTTP exceptions are also
WSGI applications by themselves which render a default error page.  So we
just catch all of them down and return the error itself.</p>
<p>If all works well, we call the function <code class="docutils literal"><span class="pre">on_</span></code> + endpoint and pass it the
request as argument as well as all the URL arguments as keyword arguments
and return the response object that method returns.</p>
</div>
<div class="section" id="step-5-the-first-view">
<h2>1.8. Step 5: The First View<a class="headerlink" href="#step-5-the-first-view" title="Permalink to this headline"></a></h2>
<p>Let&#8217;s start with the first view: the one for new URLs:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_new_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
    <span class="n">error</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">request</span><span class="o">.</span><span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;POST&#39;</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s1">&#39;url&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
            <span class="n">error</span> <span class="o">=</span> <span class="s1">&#39;Please enter a valid URL&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">short_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">insert_url</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="s1">&#39;/</span><span class="si">%s</span><span class="s1">+&#39;</span> <span class="o">%</span> <span class="n">short_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;new_url.html&#39;</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="n">error</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
<p>This logic should be easy to understand.  Basically we are checking that
the request method is POST, in which case we validate the URL and add a
new entry to the database, then redirect to the detail page.  This means
we need to write a function and a helper method.  For URL validation this
is good enough:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_valid_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="n">parts</span> <span class="o">=</span> <span class="n">urlparse</span><span class="o">.</span><span class="n">urlparse</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parts</span><span class="o">.</span><span class="n">scheme</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;http&#39;</span><span class="p">,</span> <span class="s1">&#39;https&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>For inserting the URL, all we need is this little method on our class:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">insert_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">):</span>
    <span class="n">short_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reverse-url:&#39;</span> <span class="o">+</span> <span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">short_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">short_id</span>
    <span class="n">url_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;last-url-id&#39;</span><span class="p">)</span>
    <span class="n">short_id</span> <span class="o">=</span> <span class="n">base36_encode</span><span class="p">(</span><span class="n">url_num</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;url-target:&#39;</span> <span class="o">+</span> <span class="n">short_id</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;reverse-url:&#39;</span> <span class="o">+</span> <span class="n">url</span><span class="p">,</span> <span class="n">short_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">short_id</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">reverse-url:</span></code> + the URL will store the short id.  If the URL was
already submitted this won&#8217;t be None and we can just return that value
which will be the short ID.  Otherwise we increment the <code class="docutils literal"><span class="pre">last-url-id</span></code>
key and convert it to base36.  Then we store the link and the reverse
entry in redis.  And here the function to convert to base 36:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">base36_encode</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">number</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;positive integer required&#39;</span>
    <span class="k">if</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0&#39;</span>
    <span class="n">base36</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">number</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">number</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="mi">36</span><span class="p">)</span>
        <span class="n">base36</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;0123456789abcdefghijklmnopqrstuvwxyz&#39;</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">base36</span><span class="p">))</span>
</pre></div>
</div>
<p>So what is missing for this view to work is the template.  We will create
this later, let&#8217;s first also write the other views and then do the
templates in one go.</p>
</div>
<div class="section" id="step-6-redirect-view">
<h2>1.9. Step 6: Redirect View<a class="headerlink" href="#step-6-redirect-view" title="Permalink to this headline"></a></h2>
<p>The redirect view is easy.  All it has to do is to look for the link in
redis and redirect to it.  Additionally we will also increment a counter
so that we know how often a link was clicked:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_follow_short_link</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">short_id</span><span class="p">):</span>
    <span class="n">link_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;url-target:&#39;</span> <span class="o">+</span> <span class="n">short_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">link_target</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">incr</span><span class="p">(</span><span class="s1">&#39;click-count:&#39;</span> <span class="o">+</span> <span class="n">short_id</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">redirect</span><span class="p">(</span><span class="n">link_target</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case we will raise a <code class="xref py py-exc docutils literal"><span class="pre">NotFound</span></code> exception
by hand if the URL does not exist, which will bubble up to the
<code class="docutils literal"><span class="pre">dispatch_request</span></code> function and be converted into a default 404
response.</p>
</div>
<div class="section" id="step-7-detail-view">
<h2>1.10. Step 7: Detail View<a class="headerlink" href="#step-7-detail-view" title="Permalink to this headline"></a></h2>
<p>The link detail view is very similar, we just render a template
again.  In addition to looking up the target, we also ask redis for the
number of times the link was clicked and let it default to zero if such
a key does not yet exist:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">on_short_link_details</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">short_id</span><span class="p">):</span>
    <span class="n">link_target</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;url-target:&#39;</span> <span class="o">+</span> <span class="n">short_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">link_target</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">NotFound</span><span class="p">()</span>
    <span class="n">click_count</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">redis</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;click-count:&#39;</span> <span class="o">+</span> <span class="n">short_id</span><span class="p">)</span> <span class="ow">or</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;short_link_details.html&#39;</span><span class="p">,</span>
        <span class="n">link_target</span><span class="o">=</span><span class="n">link_target</span><span class="p">,</span>
        <span class="n">short_id</span><span class="o">=</span><span class="n">short_id</span><span class="p">,</span>
        <span class="n">click_count</span><span class="o">=</span><span class="n">click_count</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Please be aware that redis always works with strings, so you have to convert
the click count to <code class="xref py py-class docutils literal"><span class="pre">int</span></code> by hand.</p>
</div>
<div class="section" id="step-8-templates">
<h2>1.11. Step 8: Templates<a class="headerlink" href="#step-8-templates" title="Permalink to this headline"></a></h2>
<p>And here are all the templates.  Just drop them into the <cite>templates</cite>
folder.  Jinja2 supports template inheritance, so the first thing we will
do is create a layout template with blocks that act as placeholders.  We
also set up Jinja2 so that it automatically escapes strings with HTML
rules, so we don&#8217;t have to spend time on that ourselves.  This prevents
XSS attacks and rendering errors.</p>
<p><em>layout.html</em>:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span></span><span class="cp">&lt;!doctype html&gt;</span>
<span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span> | shortly<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">stylesheet</span> <span class="na">href</span><span class="o">=</span><span class="s">/static/style.css</span> <span class="na">type</span><span class="o">=</span><span class="s">text/css</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">box</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">/</span><span class="p">&gt;</span>shortly<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">tagline</span><span class="p">&gt;</span>Shortly is a URL shortener written with Werkzeug
  <span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p><em>new_url.html</em>:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>Create New Short URL<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
  <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Submit URL<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">form</span> <span class="na">action</span><span class="o">=</span><span class="s">&quot;&quot;</span> <span class="na">method</span><span class="o">=</span><span class="s">post</span><span class="p">&gt;</span>
    <span class="cp">{%</span> <span class="k">if</span> <span class="nv">error</span> <span class="cp">%}</span>
      <span class="p">&lt;</span><span class="nt">p</span> <span class="na">class</span><span class="o">=</span><span class="s">error</span><span class="p">&gt;&lt;</span><span class="nt">strong</span><span class="p">&gt;</span>Error:<span class="p">&lt;/</span><span class="nt">strong</span><span class="p">&gt;</span> <span class="cp">{{</span> <span class="nv">error</span> <span class="cp">}}</span>
    <span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
    <span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>URL:
      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">text</span> <span class="na">name</span><span class="o">=</span><span class="s">url</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;</span><span class="cp">{{</span> <span class="nv">url</span> <span class="cp">}}</span><span class="s">&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">urlinput</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">submit</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;Shorten&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">form</span><span class="p">&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
<p><em>short_link_details.html</em>:</p>
<div class="highlight-html+jinja"><div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">&quot;layout.html&quot;</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">title</span> <span class="cp">%}</span>Details about /<span class="cp">{{</span> <span class="nv">short_id</span> <span class="cp">}}{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">body</span> <span class="cp">%}</span>
  <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;/</span><span class="cp">{{</span> <span class="nv">short_id</span> <span class="cp">}}</span><span class="s">&quot;</span><span class="p">&gt;</span>/<span class="cp">{{</span> <span class="nv">short_id</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">dl</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">dt</span><span class="p">&gt;</span>Full link
    <span class="p">&lt;</span><span class="nt">dd</span> <span class="na">class</span><span class="o">=</span><span class="s">link</span><span class="p">&gt;&lt;</span><span class="nt">div</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">link_target</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">dt</span><span class="p">&gt;</span>Click count:
    <span class="p">&lt;</span><span class="nt">dd</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">click_count</span> <span class="cp">}}</span>
  <span class="p">&lt;/</span><span class="nt">dl</span><span class="p">&gt;</span>
<span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<div class="section" id="step-9-the-style">
<h2>1.12. Step 9: The Style<a class="headerlink" href="#step-9-the-style" title="Permalink to this headline"></a></h2>
<p>For this to look better than ugly black and white, here a simple
stylesheet that goes along:</p>
<div class="highlight-css"><div class="highlight"><pre><span></span><span class="nt">body</span>        <span class="p">{</span> <span class="nb">background</span><span class="o">:</span> <span class="m">#E8EFF0</span><span class="p">;</span> <span class="nb">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="nb">padding</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">body</span><span class="o">,</span> <span class="nt">input</span> <span class="p">{</span> <span class="nb">font-family</span><span class="o">:</span> <span class="s1">&#39;Helvetica Neue&#39;</span><span class="o">,</span> <span class="n">Arial</span><span class="o">,</span>
              <span class="nb">sans-serif</span><span class="p">;</span> <span class="nb">font-weight</span><span class="o">:</span> <span class="m">300</span><span class="p">;</span> <span class="nb">font-size</span><span class="o">:</span> <span class="m">18px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.box</span>        <span class="p">{</span> <span class="nb">width</span><span class="o">:</span> <span class="m">500px</span><span class="p">;</span> <span class="nb">margin</span><span class="o">:</span> <span class="m">60px</span> <span class="nb">auto</span><span class="p">;</span> <span class="nb">padding</span><span class="o">:</span> <span class="m">20px</span><span class="p">;</span>
              <span class="nb">background</span><span class="o">:</span> <span class="nb">white</span><span class="p">;</span> <span class="n">box</span><span class="o">-</span><span class="n">shadow</span><span class="o">:</span> <span class="m">0</span> <span class="m">1px</span> <span class="m">4px</span> <span class="m">#BED1D4</span><span class="p">;</span>
              <span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">2px</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">a</span>           <span class="p">{</span> <span class="nb">color</span><span class="o">:</span> <span class="m">#11557C</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">h1</span><span class="o">,</span> <span class="nt">h2</span>      <span class="p">{</span> <span class="nb">margin</span><span class="o">:</span> <span class="m">0</span><span class="p">;</span> <span class="nb">color</span><span class="o">:</span> <span class="m">#11557C</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">h1</span> <span class="nt">a</span>        <span class="p">{</span> <span class="nb">text-decoration</span><span class="o">:</span> <span class="nb">none</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">h2</span>          <span class="p">{</span> <span class="nb">font-weight</span><span class="o">:</span> <span class="nb">normal</span><span class="p">;</span> <span class="nb">font-size</span><span class="o">:</span> <span class="m">24px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.tagline</span>    <span class="p">{</span> <span class="nb">color</span><span class="o">:</span> <span class="m">#888</span><span class="p">;</span> <span class="nb">font-style</span><span class="o">:</span> <span class="nb">italic</span><span class="p">;</span> <span class="nb">margin</span><span class="o">:</span> <span class="m">0</span> <span class="m">0</span> <span class="m">20px</span> <span class="m">0</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.link</span> <span class="nt">div</span>   <span class="p">{</span> <span class="nb">overflow</span><span class="o">:</span> <span class="nb">auto</span><span class="p">;</span> <span class="nb">font-size</span><span class="o">:</span> <span class="m">0.8em</span><span class="p">;</span> <span class="nb">white-space</span><span class="o">:</span> <span class="n">pre</span><span class="p">;</span>
              <span class="nb">padding</span><span class="o">:</span> <span class="m">4px</span> <span class="m">10px</span><span class="p">;</span> <span class="nb">margin</span><span class="o">:</span> <span class="m">5px</span> <span class="m">0</span><span class="p">;</span> <span class="nb">background</span><span class="o">:</span> <span class="m">#E5EAF1</span><span class="p">;</span> <span class="p">}</span>
<span class="nt">dt</span>          <span class="p">{</span> <span class="nb">font-weight</span><span class="o">:</span> <span class="nb">normal</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.error</span>      <span class="p">{</span> <span class="nb">background</span><span class="o">:</span> <span class="m">#E8EFF0</span><span class="p">;</span> <span class="nb">padding</span><span class="o">:</span> <span class="m">3px</span> <span class="m">8px</span><span class="p">;</span> <span class="nb">color</span><span class="o">:</span> <span class="m">#11557C</span><span class="p">;</span>
              <span class="nb">font-size</span><span class="o">:</span> <span class="m">0.9em</span><span class="p">;</span> <span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">2px</span><span class="p">;</span> <span class="p">}</span>
<span class="nc">.urlinput</span>   <span class="p">{</span> <span class="nb">width</span><span class="o">:</span> <span class="m">300px</span><span class="p">;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="bonus-refinements">
<h2>1.13. Bonus: Refinements<a class="headerlink" href="#bonus-refinements" title="Permalink to this headline"></a></h2>
<p>Look at the implementation in the example dictionary in the Werkzeug
repository to see a version of this tutorial with some small refinements
such as a custom 404 page.</p>
<ul class="simple">
<li><a class="reference external" href="https://github.com/pallets/werkzeug/blob/master/examples/shortly">shortly in the example folder</a></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="werk_doc.quickstart.html" class="btn btn-neutral float-right" title="2. Quickstart" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="werk_doc.html" class="btn btn-neutral" title="Werkzeug doc materials" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>