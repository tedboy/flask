

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>9. The Request Context &mdash; Flask API</title>
  

  
  
    <link rel="shortcut icon" href="_static/flask-favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Flask API" href="index.html"/>
        <link rel="up" title="Other Flask doc materials" href="flask_doc.html"/>
        <link rel="next" title="10. Modular Applications with Blueprints" href="flask_doc.blueprints.html"/>
        <link rel="prev" title="8. The Application Context" href="flask_doc.appcontext.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Flask API
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="tutorial/index.html">Flask Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="tutorial/introduction.html">Introducing Flaskr</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/folders.html">Step 0: Creating The Folders</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/schema.html">Step 1: Database Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/setup.html">Step 2: Application Setup Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/setuptools.html">Step 3: Installing flaskr with setuptools</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/dbcon.html">Step 4: Database Connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/dbinit.html">Step 5: Creating The Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/views.html">Step 7: The View Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/views.html#show-entries">Show Entries</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/views.html#add-new-entry">Add New Entry</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/views.html#login-and-logout">Login and Logout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/templates.html">Step 8: The Templates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="tutorial/templates.html#layout-html">layout.html</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/templates.html#show-entries-html">show_entries.html</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial/templates.html#login-html">login.html</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/css.html">Step 9: Adding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/testing.html">Bonus: Testing the Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/testing.html#adding-tests-to-flaskr">Adding Tests to flaskr</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/testing.html#testing-setuptools">Testing + Setuptools</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quickstart/flask_doc.quickstart.html">Flask &#8212; Quickstart</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart1.html">1. A Minimal Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart2.html">2. What to do if the Server does not Start</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart2.html#old-version-of-flask">2.1. Old Version of Flask</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart2.html#invalid-import-name">2.2. Invalid Import Name</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart3.html">3. Debug Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart4.html">4. Routing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart4.html#variable-rules">4.1. Variable Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart4.html#url-building">4.2. URL Building</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart4.html#http-methods">4.3. HTTP Methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart5.html">5. Static Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart6.html">6. Rendering Templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart7.html">7. Accessing Request Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#context-locals">7.1. Context Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#the-request-object">7.2. The Request Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#file-uploads">7.3. File Uploads</a></li>
<li class="toctree-l3"><a class="reference internal" href="quickstart/quickstart7.html#cookies">7.4. Cookies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart8.html">8. Redirects and Errors</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart9.html">9. About Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart10.html">10. Sessions</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart11.html">11. Message Flashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart12.html">12. Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart13.html">13. Hooking in WSGI Middlewares</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart13.html#using-flask-extensions">14. Using Flask Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="quickstart/quickstart13.html#deploying-to-a-web-server">15. Deploying to a Web Server</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns/index1.html">Patterns for Flask (part1)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns/packages.html">1. Larger Applications</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/packages.html#simple-packages">1.1. Simple Packages</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/packages.html#working-with-blueprints">1.2. Working with Blueprints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/appfactories.html">2. Application Factories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#basic-factories">2.1. Basic Factories</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#factories-extensions">2.2. Factories &amp; Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#using-applications">2.3. Using Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appfactories.html#factory-improvements">2.4. Factory Improvements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/appdispatch.html">3. Application Dispatching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#working-with-this-document">3.1. Working with this Document</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#combining-applications">3.2. Combining Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#dispatch-by-subdomain">3.3. Dispatch by Subdomain</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/appdispatch.html#dispatch-by-path">3.4. Dispatch by Path</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/apierrors.html">4. Implementing API Exceptions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/apierrors.html#simple-exception-class">4.1. Simple Exception Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/apierrors.html#registering-an-error-handler">4.2. Registering an Error Handler</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/apierrors.html#usage-in-views">4.3. Usage in Views</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/urlprocessors.html">5. Using URL Processors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/urlprocessors.html#internationalized-application-urls">5.1. Internationalized Application URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/urlprocessors.html#internationalized-blueprint-urls">5.2. Internationalized Blueprint URLs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/distribute.html">6. Deploying with Setuptools</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#basic-setup-script">6.1. Basic Setup Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#tagging-builds">6.2. Tagging Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#distributing-resources">6.3. Distributing Resources</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#declaring-dependencies">6.4. Declaring Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/distribute.html#installing-developing">6.5. Installing / Developing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/fabric.html">7. Deploying with Fabric</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#creating-the-first-fabfile">7.1. Creating the first Fabfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#running-fabfiles">7.2. Running Fabfiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#the-wsgi-file">7.3. The WSGI File</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#the-configuration-file">7.4. The Configuration File</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#first-deployment">7.5. First Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fabric.html#next-steps">7.6. Next Steps</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/sqlite3.html">8. Using SQLite 3 with Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlite3.html#connect-on-demand">8.1. Connect on Demand</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlite3.html#easy-querying">8.2. Easy Querying</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlite3.html#initial-schemas">8.3. Initial Schemas</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/sqlalchemy.html">9. SQLAlchemy in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#flask-sqlalchemy-extension">9.1. Flask-SQLAlchemy Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#declarative">9.2. Declarative</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#manual-object-relational-mapping">9.3. Manual Object Relational Mapping</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/sqlalchemy.html#sql-abstraction-layer">9.4. SQL Abstraction Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/fileuploads.html">10. Uploading Files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#a-gentle-introduction">10.1. A Gentle Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#improving-uploads">10.2. Improving Uploads</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#upload-progress-bars">10.3. Upload Progress Bars</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/fileuploads.html#an-easier-solution">10.4. An Easier Solution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/caching.html">11. Caching</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/caching.html#setting-up-a-cache">11.1. Setting up a Cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/caching.html#using-a-cache">11.2. Using a Cache</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/viewdecorators.html">12. View Decorators</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#login-required-decorator">12.1. Login Required Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#caching-decorator">12.2. Caching Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#templating-decorator">12.3. Templating Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/viewdecorators.html#endpoint-decorator">12.4. Endpoint Decorator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/wtforms.html">13. Form Validation with WTForms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/wtforms.html#the-forms">13.1. The Forms</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/wtforms.html#in-the-view">13.2. In the View</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/wtforms.html#forms-in-templates">13.3. Forms in Templates</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns/index2.html">Patterns for Flask (part2)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns/templateinheritance.html">1. Template Inheritance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/templateinheritance.html#base-template">1.1. Base Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/templateinheritance.html#child-template">1.2. Child Template</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/flashing.html">2. Message Flashing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/flashing.html#simple-flashing">2.1. Simple Flashing</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/flashing.html#flashing-with-categories">2.2. Flashing With Categories</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/flashing.html#filtering-flash-messages">2.3. Filtering Flash Messages</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/jquery.html">3. AJAX with jQuery</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#loading-jquery">3.1. Loading jQuery</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#where-is-my-site">3.2. Where is My Site?</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#json-view-functions">3.3. JSON View Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/jquery.html#the-html">3.4. The HTML</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/errorpages.html">4. Custom Error Pages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/errorpages.html#common-error-codes">4.1. Common Error Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/errorpages.html#error-handlers">4.2. Error Handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/lazyloading.html">5. Lazily Loading Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/lazyloading.html#converting-to-centralized-url-map">5.1. Converting to Centralized URL Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/lazyloading.html#loading-late">5.2. Loading Late</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/mongokit.html">6. MongoKit in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/mongokit.html#declarative">6.1. Declarative</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/mongokit.html#pymongo-compatibility-layer">6.2. PyMongo Compatibility Layer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/favicon.html">7. Adding a favicon</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/favicon.html#see-also">7.1. See also</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/streaming.html">8. Streaming Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/streaming.html#basic-usage">8.1. Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/streaming.html#streaming-from-templates">8.2. Streaming from Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/streaming.html#streaming-with-context">8.3. Streaming with Context</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/deferredcallbacks.html">9. Deferred Request Callbacks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/deferredcallbacks.html#the-decorator">9.1. The Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/deferredcallbacks.html#calling-the-deferred">9.2. Calling the Deferred</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/deferredcallbacks.html#a-practical-example">9.3. A Practical Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/methodoverrides.html">10. Adding HTTP Method Overrides</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns/requestchecksum.html">11. Request Content Checksums</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns/celery.html">12. Celery Based Background Tasks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#installing-celery">12.1. Installing Celery</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#configuring-celery">12.2. Configuring Celery</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#minimal-example">12.3. Minimal Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns/celery.html#running-the-celery-worker">12.4. Running the Celery Worker</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns/subclassing.html">13. Subclassing Flask</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploying/index.html">Deployment Options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="deploying/index.html#hosted-options">Hosted options</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploying/index.html#self-hosted-options">Self-hosted options</a><ul>
<li class="toctree-l3"><a class="reference internal" href="deploying/mod_wsgi.html">1. mod_wsgi (Apache)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#installing-mod-wsgi">1.1. Installing <cite>mod_wsgi</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#creating-a-wsgi-file">1.2. Creating a <cite>.wsgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#configuring-apache">1.3. Configuring Apache</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#troubleshooting">1.4. Troubleshooting</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#support-for-automatic-reloading">1.5. Support for Automatic Reloading</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/mod_wsgi.html#working-with-virtual-environments">1.6. Working with Virtual Environments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/wsgi-standalone.html">2. Standalone WSGI Containers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#gunicorn">2.1. Gunicorn</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#gevent">2.2. Gevent</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#twisted-web">2.3. Twisted Web</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/wsgi-standalone.html#proxy-setups">2.4. Proxy Setups</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/uwsgi.html">3. uWSGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/uwsgi.html#starting-your-app-with-uwsgi">3.1. Starting your app with uwsgi</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/uwsgi.html#configuring-nginx">3.2. Configuring nginx</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/fastcgi.html">4. FastCGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#creating-a-fcgi-file">4.1. Creating a <cite>.fcgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#configuring-apache">4.2. Configuring Apache</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#configuring-lighttpd">4.3. Configuring lighttpd</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#configuring-nginx">4.4. Configuring nginx</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#running-fastcgi-processes">4.5. Running FastCGI Processes</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/fastcgi.html#debugging">4.6. Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="deploying/cgi.html">5. CGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="deploying/cgi.html#creating-a-cgi-file">5.1. Creating a <cite>.cgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="deploying/cgi.html#server-setup">5.2. Server Setup</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc.templating.html">1&nbsp;&nbsp;&nbsp;Flask &#8212; Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#jinja-setup">1.1&nbsp;&nbsp;&nbsp;Jinja Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#standard-context">1.2&nbsp;&nbsp;&nbsp;Standard Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#standard-filters">1.3&nbsp;&nbsp;&nbsp;Standard Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#controlling-autoescaping">1.4&nbsp;&nbsp;&nbsp;Controlling Autoescaping</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#registering-filters">1.5&nbsp;&nbsp;&nbsp;Registering Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.templating.html#context-processors">1.6&nbsp;&nbsp;&nbsp;Context Processors</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc.config.html">1&nbsp;&nbsp;&nbsp;Configuration Handling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#configuration-basics">1.1&nbsp;&nbsp;&nbsp;Configuration Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#builtin-configuration-values">1.2&nbsp;&nbsp;&nbsp;Builtin Configuration Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#configuring-from-files">1.3&nbsp;&nbsp;&nbsp;Configuring from Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#configuration-best-practices">1.4&nbsp;&nbsp;&nbsp;Configuration Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#development-production">1.5&nbsp;&nbsp;&nbsp;Development / Production</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.config.html#instance-folders">1.6&nbsp;&nbsp;&nbsp;Instance Folders</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc.testing.html">1&nbsp;&nbsp;&nbsp;Testing Flask Applications</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#the-application">1.1&nbsp;&nbsp;&nbsp;The Application</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#the-testing-skeleton">1.2&nbsp;&nbsp;&nbsp;The Testing Skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#the-first-test">1.3&nbsp;&nbsp;&nbsp;The First Test</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#logging-in-and-out">1.4&nbsp;&nbsp;&nbsp;Logging In and Out</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#test-adding-messages">1.5&nbsp;&nbsp;&nbsp;Test Adding Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#other-testing-tricks">1.6&nbsp;&nbsp;&nbsp;Other Testing Tricks</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#faking-resources-and-context">1.7&nbsp;&nbsp;&nbsp;Faking Resources and Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#keeping-the-context-around">1.8&nbsp;&nbsp;&nbsp;Keeping the Context Around</a></li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.testing.html#accessing-and-modifying-sessions">1.9&nbsp;&nbsp;&nbsp;Accessing and Modifying Sessions</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="flask_doc.html">Other Flask doc materials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="flask_doc.foreword.html">1. Foreword</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#what-does-micro-mean">1.1. What does &#8220;micro&#8221; mean?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#configuration-and-conventions">1.2. Configuration and Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.foreword.html#growing-with-flask">1.3. Growing with Flask</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.advanced_foreword.html">2. Foreword for Experienced Programmers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#thread-locals-in-flask">2.1. Thread-Locals in Flask</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#develop-for-the-web-with-caution">2.2. Develop for the Web with Caution</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.advanced_foreword.html#python-3-support-in-flask">2.3. Python 3 Support in Flask</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.installation.html">3. Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#virtualenv">3.1. virtualenv</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#system-wide-installation">3.2. System-Wide Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#living-on-the-edge">3.3. Living on the Edge</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.installation.html#pip-and-setuptools-on-windows">3.4. <cite>pip</cite> and <cite>setuptools</cite> on Windows</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.errorhandling.html">4. Application Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-logging-tools">4.1. Error Logging Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-handlers">4.2. Error handlers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#registering">4.2.1. Registering</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#handling">4.2.2. Handling</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#error-mails">4.3. Error Mails</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#logging-to-a-file">4.4. Logging to a File</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#controlling-the-log-format">4.5. Controlling the Log Format</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#email">4.5.1. Email</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#file-logging">4.5.2. File logging</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.errorhandling.html#complex-log-formatting">4.5.3. Complex Log Formatting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#other-libraries">4.6. Other Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.errorhandling.html#debugging-application-errors">5. Debugging Application Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#when-in-doubt-run-manually">5.1. When in Doubt, Run Manually</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.errorhandling.html#working-with-debuggers">5.2. Working with Debuggers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.signals.html">6. Signals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#subscribing-to-signals">6.1. Subscribing to Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#creating-signals">6.2. Creating Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#sending-signals">6.3. Sending Signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#signals-and-flask-s-request-context">6.4. Signals and Flask&#8217;s Request Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#decorator-based-signal-subscriptions">6.5. Decorator Based Signal Subscriptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.signals.html#core-signals">6.6. Core Signals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.views.html">7. Pluggable Views</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#basic-principle">7.1. Basic Principle</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-hints">7.2. Method Hints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-based-dispatching">7.3. Method Based Dispatching</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#decorating-views">7.4. Decorating Views</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.views.html#method-views-for-apis">7.5. Method Views for APIs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.appcontext.html">8. The Application Context</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#purpose-of-the-application-context">8.1. Purpose of the Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#creating-an-application-context">8.2. Creating an Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#locality-of-the-context">8.3. Locality of the Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.appcontext.html#context-usage">8.4. Context Usage</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="">9. The Request Context</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#diving-into-context-locals">9.1. Diving into Context Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-the-context-works">9.2. How the Context Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="#callbacks-and-errors">9.3. Callbacks and Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#teardown-callbacks">9.4. Teardown Callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#notes-on-proxies">9.5. Notes On Proxies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#context-preservation-on-error">9.6. Context Preservation on Error</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.blueprints.html">10. Modular Applications with Blueprints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#why-blueprints">10.1. Why Blueprints?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#the-concept-of-blueprints">10.2. The Concept of Blueprints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#my-first-blueprint">10.3. My First Blueprint</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#registering-blueprints">10.4. Registering Blueprints</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#blueprint-resources">10.5. Blueprint Resources</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#blueprint-resource-folder">10.5.1. Blueprint Resource Folder</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#static-files">10.5.2. Static Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.blueprints.html#templates">10.5.3. Templates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#building-urls">10.6. Building URLs</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.blueprints.html#error-handlers">10.7. Error Handlers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.extensions.html">11. Flask Extensions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#finding-extensions">11.1. Finding Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#using-extensions">11.2. Using Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#building-extensions">11.3. Building Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensions.html#flask-before-0-8">11.4. Flask Before 0.8</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.cli.html">12. Command Line Interface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#basic-usage">12.1. Basic Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#virtualenv-integration">12.2. Virtualenv Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#debug-flag">12.3. Debug Flag</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#running-a-shell">12.4. Running a Shell</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#custom-commands">12.5. Custom Commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#application-context">12.6. Application Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#factory-functions">12.7. Factory Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#custom-scripts">12.8. Custom Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.cli.html#cli-plugins">12.9. CLI Plugins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.server.html">13. Development Server</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.server.html#command-line">13.1. Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.server.html#in-code">13.2. In Code</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.shell.html">14. Working with the Shell</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#command-line-interface">14.1. Command Line Interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#creating-a-request-context">14.2. Creating a Request Context</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#firing-before-after-request">14.3. Firing Before/After Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.shell.html#further-improving-the-shell-experience">14.4. Further Improving the Shell Experience</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.becomingbig.html">15. Becoming Big</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#read-the-source">15.1. Read the Source.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#hook-extend">15.2. Hook. Extend.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#subclass">15.3. Subclass.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#wrap-with-middleware">15.4. Wrap with middleware.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#fork">15.5. Fork.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#scale-like-a-pro">15.6. Scale like a pro.</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.becomingbig.html#discuss-with-the-community">15.7. Discuss with the community.</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="flask_doc2.html">Flask doc &#8212; Additional Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.design.html">1. Design Decisions in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#the-explicit-application-object">1.1. The Explicit Application Object</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#the-routing-system">1.2. The Routing System</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#one-template-engine">1.3. One Template Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#micro-with-dependencies">1.4. Micro with Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#thread-locals">1.5. Thread Locals</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.design.html#what-flask-is-what-flask-is-not">1.6. What Flask is, What Flask is Not</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.htmlfaq.html">2. HTML/XHTML FAQ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#history-of-xhtml">2.1. History of XHTML</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#history-of-html5">2.2. History of HTML5</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#html-versus-xhtml">2.3. HTML versus XHTML</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#what-does-strict-mean">2.4. What does &#8220;strict&#8221; mean?</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#new-technologies-in-html5">2.5. New technologies in HTML5</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.htmlfaq.html#what-should-be-used">2.6. What should be used?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.security.html">3. Security Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#cross-site-scripting-xss">3.1. Cross-Site Scripting (XSS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#cross-site-request-forgery-csrf">3.2. Cross-Site Request Forgery (CSRF)</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.security.html#json-security">3.3. JSON Security</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.unicode.html">4. Unicode in Flask</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#automatic-conversion">4.1. Automatic Conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#the-golden-rule">4.2. The Golden Rule</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#encoding-and-decoding-yourself">4.3. Encoding and Decoding Yourself</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.unicode.html#configuring-editors">4.4. Configuring Editors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.extensiondev.html">5. Flask Extension Development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#anatomy-of-an-extension">5.1. Anatomy of an Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#hello-flaskext">5.2. &#8220;Hello Flaskext!&#8221;</a><ul>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.extensiondev.html#setup-py">5.2.1. setup.py</a></li>
<li class="toctree-l4"><a class="reference internal" href="flask_doc.extensiondev.html#flask-sqlite3-py">5.2.2. flask_sqlite3.py</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#initializing-extensions">5.3. Initializing Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#the-extension-code">5.4. The Extension Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#using-app-ctx-stack">5.5. Using _app_ctx_stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#teardown-behavior">5.6. Teardown Behavior</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#learn-from-others">5.7. Learn from Others</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#approved-extensions">5.8. Approved Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.extensiondev.html#extension-import-transition">5.9. Extension Import Transition</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="flask_doc.styleguide.html">6. Pocoo Styleguide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#general-layout">6.1. General Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#expressions-and-statements">6.2. Expressions and Statements</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#naming-conventions">6.3. Naming Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#docstrings">6.4. Docstrings</a></li>
<li class="toctree-l3"><a class="reference internal" href="flask_doc.styleguide.html#comments">6.5. Comments</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="werk_doc.html">Werkzeug doc materials</a><ul>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.tutorial.html">1. Werkzeug Tutorial</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#introducing-shortly">1.1. Introducing Shortly</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-0-a-basic-wsgi-introduction">1.2. Step 0: A Basic WSGI Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-1-creating-the-folders">1.3. Step 1: Creating the Folders</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-2-the-base-structure">1.4. Step 2: The Base Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#intermezzo-running-the-application">1.5. Intermezzo: Running the Application</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-3-the-environment">1.6. Step 3: The Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-4-the-routing">1.7. Step 4: The Routing</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-5-the-first-view">1.8. Step 5: The First View</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-6-redirect-view">1.9. Step 6: Redirect View</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-7-detail-view">1.10. Step 7: Detail View</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-8-templates">1.11. Step 8: Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#step-9-the-style">1.12. Step 9: The Style</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.tutorial.html#bonus-refinements">1.13. Bonus: Refinements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.quickstart.html">2. Quickstart</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#wsgi-environment">2.1. WSGI Environment</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#enter-request">2.2. Enter Request</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#header-parsing">2.3. Header Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.quickstart.html#responses">2.4. Responses</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="werk_doc.deployment.html">3. Application Deployment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.cgi.html">3.1. CGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.cgi.html#creating-a-cgi-file">3.1.1. Creating a <cite>.cgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.cgi.html#server-setup">3.1.2. Server Setup</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html">3.2. <cite>mod_wsgi</cite> (Apache)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#installing-mod-wsgi">3.2.1. Installing <cite>mod_wsgi</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#creating-a-wsgi-file">3.2.2. Creating a <cite>.wsgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.mod_wsgi.html#configuring-apache">3.2.3. Configuring Apache</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.fastcgi.html">3.3. FastCGI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#creating-a-fcgi-file">3.3.1. Creating a <cite>.fcgi</cite> file</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#configuring-lighttpd">3.3.2. Configuring lighttpd</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#configuring-nginx">3.3.3. Configuring nginx</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.fastcgi.html#debugging">3.3.4. Debugging</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="werk_doc.deployment.proxying.html">3.4. HTTP Proxying</a><ul>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.proxying.html#creating-a-py-server">3.4.1. Creating a <cite>.py</cite> server</a></li>
<li class="toctree-l4"><a class="reference internal" href="werk_doc.deployment.proxying.html#configuring-nginx">3.4.2. Configuring nginx</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Flask API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="flask_doc.html">Other Flask doc materials</a> &raquo;</li>
        
      <li>9. The Request Context</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/flask_doc.reqcontext.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-request-context">
<span id="request-context"></span><h1>9. The Request Context<a class="headerlink" href="#the-request-context" title="Permalink to this headline"></a></h1>
<p>This document describes the behavior in Flask 0.7 which is mostly in line
with the old behavior but has some small, subtle differences.</p>
<p>It is recommended that you read the <a class="reference internal" href="flask_doc.appcontext.html#app-context"><span>The Application Context</span></a> chapter first.</p>
<div class="section" id="diving-into-context-locals">
<h2>9.1. Diving into Context Locals<a class="headerlink" href="#diving-into-context-locals" title="Permalink to this headline"></a></h2>
<p>Say you have a utility function that returns the URL the user should be
redirected to.  Imagine it would always redirect to the URL&#8217;s <code class="docutils literal"><span class="pre">next</span></code>
parameter or the HTTP referrer or the index page:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">request</span><span class="p">,</span> <span class="n">url_for</span>

<span class="k">def</span> <span class="nf">redirect_url</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;next&#39;</span><span class="p">)</span> <span class="ow">or</span> \
           <span class="n">request</span><span class="o">.</span><span class="n">referrer</span> <span class="ow">or</span> \
           <span class="n">url_for</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>As you can see, it accesses the request object.  If you try to run this
from a plain Python shell, this is the exception you will see:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">redirect_url</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;NoneType&#39; object has no attribute &#39;request&#39;</span>
</pre></div>
</div>
<p>That makes a lot of sense because we currently do not have a request we
could access.  So we have to make a request and bind it to the current
context.  The <code class="xref py py-attr docutils literal"><span class="pre">test_request_context</span></code> method can create
us a <code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">(</span><span class="s1">&#39;/?next=http://example.com/&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This context can be used in two ways.  Either with the <code class="docutils literal"><span class="pre">with</span></code> statement
or by calling the <code class="xref py py-meth docutils literal"><span class="pre">push()</span></code> and
<code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code> methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
</pre></div>
</div>
<p>From that point onwards you can work with the request object:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">redirect_url</span><span class="p">()</span>
<span class="go">u&#39;http://example.com/&#39;</span>
</pre></div>
</div>
<p>Until you call <cite>pop</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<p>Because the request context is internally maintained as a stack you can
push and pop multiple times.  This is very handy to implement things like
internal redirects.</p>
<p>For more information of how to utilize the request context from the
interactive Python shell, head over to the <a class="reference internal" href="flask_doc.shell.html#shell"><span>Working with the Shell</span></a> chapter.</p>
</div>
<div class="section" id="how-the-context-works">
<h2>9.2. How the Context Works<a class="headerlink" href="#how-the-context-works" title="Permalink to this headline"></a></h2>
<p>If you look into how the Flask WSGI application internally works, you will
find a piece of code that looks very much like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">wsgi_app</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">environ</span><span class="p">):</span>
    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_context</span><span class="p">(</span><span class="n">environ</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_dispatch_request</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">make_response</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_exception</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">response</span><span class="p">(</span><span class="n">environ</span><span class="p">,</span> <span class="n">start_response</span><span class="p">)</span>
</pre></div>
</div>
<p>The method <code class="xref py py-meth docutils literal"><span class="pre">request_context()</span></code> returns a new
<code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code> object and uses it in combination with
the <code class="docutils literal"><span class="pre">with</span></code> statement to bind the context.  Everything that is called from
the same thread from this point onwards until the end of the <code class="docutils literal"><span class="pre">with</span></code>
statement will have access to the request globals (<code class="xref py py-data docutils literal"><span class="pre">flask.request</span></code>
and others).</p>
<p>The request context internally works like a stack: The topmost level on
the stack is the current active request.
<code class="xref py py-meth docutils literal"><span class="pre">push()</span></code> adds the context to the stack on
the very top, <code class="xref py py-meth docutils literal"><span class="pre">pop()</span></code> removes it from the
stack again.  On popping the application&#8217;s
<code class="xref py py-func docutils literal"><span class="pre">teardown_request()</span></code> functions are also executed.</p>
<p>Another thing of note is that the request context will automatically also
create an <a class="reference internal" href="flask_doc.appcontext.html#app-context"><span>application context</span></a> when it&#8217;s pushed and
there is no application context for that application so far.</p>
</div>
<div class="section" id="callbacks-and-errors">
<span id="id1"></span><h2>9.3. Callbacks and Errors<a class="headerlink" href="#callbacks-and-errors" title="Permalink to this headline"></a></h2>
<p>What happens if an error occurs in Flask during request processing?  This
particular behavior changed in 0.7 because we wanted to make it easier to
understand what is actually happening.  The new behavior is quite simple:</p>
<ol class="arabic simple">
<li>Before each request, <code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code> functions are
executed.  If one of these functions return a response, the other
functions are no longer called.  In any case however the return value
is treated as a replacement for the view&#8217;s return value.</li>
<li>If the <code class="xref py py-meth docutils literal"><span class="pre">before_request()</span></code> functions did not return a
response, the regular request handling kicks in and the view function
that was matched has the chance to return a response.</li>
<li>The return value of the view is then converted into an actual response
object and handed over to the <code class="xref py py-meth docutils literal"><span class="pre">after_request()</span></code>
functions which have the chance to replace it or modify it in place.</li>
<li>At the end of the request the <code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code>
functions are executed.  This always happens, even in case of an
unhandled exception down the road or if a before-request handler was
not executed yet or at all (for example in test environments sometimes
you might want to not execute before-request callbacks).</li>
</ol>
<p>Now what happens on errors?  In production mode if an exception is not
caught, the 500 internal server handler is called.  In development mode
however the exception is not further processed and bubbles up to the WSGI
server.  That way things like the interactive debugger can provide helpful
debug information.</p>
<p>An important change in 0.7 is that the internal server error is now no
longer post processed by the after request callbacks and after request
callbacks are no longer guaranteed to be executed.  This way the internal
dispatching code looks cleaner and is easier to customize and understand.</p>
<p>The new teardown functions are supposed to be used as a replacement for
things that absolutely need to happen at the end of request.</p>
</div>
<div class="section" id="teardown-callbacks">
<h2>9.4. Teardown Callbacks<a class="headerlink" href="#teardown-callbacks" title="Permalink to this headline"></a></h2>
<p>The teardown callbacks are special callbacks in that they are executed at
a different point.  Strictly speaking they are independent of the actual
request handling as they are bound to the lifecycle of the
<code class="xref py py-class docutils literal"><span class="pre">RequestContext</span></code> object.  When the request context is
popped, the <code class="xref py py-meth docutils literal"><span class="pre">teardown_request()</span></code> functions are called.</p>
<p>This is important to know if the life of the request context is prolonged
by using the test client in a with statement or when using the request
context from the command line:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">app</span><span class="o">.</span><span class="n">test_client</span><span class="p">()</span> <span class="k">as</span> <span class="n">client</span><span class="p">:</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;/foo&#39;</span><span class="p">)</span>
    <span class="c1"># the teardown functions are still not called at that point</span>
    <span class="c1"># even though the response ended and you have the response</span>
    <span class="c1"># object in your hand</span>

<span class="c1"># only when the code reaches this point the teardown functions</span>
<span class="c1"># are called.  Alternatively the same thing happens if another</span>
<span class="c1"># request was triggered from the test client</span>
</pre></div>
</div>
<p>It&#8217;s easy to see the behavior from the command line:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nd">@app.teardown_request</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">teardown_request</span><span class="p">(</span><span class="n">exception</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s1">&#39;this runs after request&#39;</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">test_request_context</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">push</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ctx</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
<span class="go">this runs after request</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>
</div>
<p>Keep in mind that teardown callbacks are always executed, even if
before-request callbacks were not executed yet but an exception happened.
Certain parts of the test system might also temporarily create a request
context without calling the before-request handlers.  Make sure to write
your teardown-request handlers in a way that they will never fail.</p>
</div>
<div class="section" id="notes-on-proxies">
<span id="id2"></span><h2>9.5. Notes On Proxies<a class="headerlink" href="#notes-on-proxies" title="Permalink to this headline"></a></h2>
<p>Some of the objects provided by Flask are proxies to other objects.  The
reason behind this is that these proxies are shared between threads and
they have to dispatch to the actual object bound to a thread behind the
scenes as necessary.</p>
<p>Most of the time you don&#8217;t have to care about that, but there are some
exceptions where it is good to know that this object is an actual proxy:</p>
<ul class="simple">
<li>The proxy objects do not fake their inherited types, so if you want to
perform actual instance checks, you have to do that on the instance
that is being proxied (see <cite>_get_current_object</cite> below).</li>
<li>if the object reference is important (so for example for sending
<a class="reference internal" href="flask_doc.signals.html#signals"><span>Signals</span></a>)</li>
</ul>
<p>If you need to get access to the underlying object that is proxied, you
can use the <code class="xref py py-meth docutils literal"><span class="pre">_get_current_object()</span></code> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">app</span> <span class="o">=</span> <span class="n">current_app</span><span class="o">.</span><span class="n">_get_current_object</span><span class="p">()</span>
<span class="n">my_signal</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">app</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="context-preservation-on-error">
<h2>9.6. Context Preservation on Error<a class="headerlink" href="#context-preservation-on-error" title="Permalink to this headline"></a></h2>
<p>If an error occurs or not, at the end of the request the request context
is popped and all data associated with it is destroyed.  During
development however that can be problematic as you might want to have the
information around for a longer time in case an exception occurred.  In
Flask 0.6 and earlier in debug mode, if an exception occurred, the
request context was not popped so that the interactive debugger can still
provide you with important information.</p>
<p>Starting with Flask 0.7 you have finer control over that behavior by
setting the <code class="docutils literal"><span class="pre">PRESERVE_CONTEXT_ON_EXCEPTION</span></code> configuration variable.  By
default it&#8217;s linked to the setting of <code class="docutils literal"><span class="pre">DEBUG</span></code>.  If the application is in
debug mode the context is preserved, in production mode it&#8217;s not.</p>
<p>Do not force activate <code class="docutils literal"><span class="pre">PRESERVE_CONTEXT_ON_EXCEPTION</span></code> in production mode
as it will cause your application to leak memory on exceptions.  However
it can be useful during development to get the same error preserving
behavior as in development mode when attempting to debug an error that
only occurs under production settings.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="flask_doc.blueprints.html" class="btn btn-neutral float-right" title="10. Modular Applications with Blueprints" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="flask_doc.appcontext.html" class="btn btn-neutral" title="8. The Application Context" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/copybutton.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>